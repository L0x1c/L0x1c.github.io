<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>dy a_bogus参数 逆向分析 | L0x1c&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="关于dy的a_bogus逆向，jsvmp
进行抖音抓包，对应的位置在
url = &#34;https://www.douyin.com/aweme/v1/web/aweme/post/&#34; 可以看一下调用栈，不难发现主要的逻辑在bdms_1.0.1.19_fix.js
直接跳过去可以看到d就是指令操作
先一点一点的去看
这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key
再用自定义 map 函数 _ 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC
import base64, zlib, re, hashlib, os, sys from pathlib import Path BASE64_DATA = r&#34;&#34;&#34; &#34;&#34;&#34;.strip() # ============================================== def sanitize_b64(s: str) -&gt; str: return re.sub(r&#39;[^A-Za-z0-9&#43;/=]&#39;, &#39;&#39;, s) def xor_transform(decoded: bytes) -&gt; tuple[bytes, int, int]: key_sum = sum(decoded[4:8]) &amp; 0xFFFFFFFF km = key_sum % 256 step = km % 10 tail = decoded[8:] out = bytearray(len(tail)) for i, b in enumerate(tail): out[i] = (b ^ ((km &#43; step * i) % 256)) &amp; 0xFF return bytes(out), key_sum, km def inflate_raw(data: bytes) -&gt; bytes: return zlib.">
<meta name="author" content="L0x1c">
<link rel="canonical" href="https://l0x1c.com/posts/dy_web_a_bogus/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://l0x1c.com/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://l0x1c.com/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://l0x1c.com/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://l0x1c.com/apple-touch-icon.png">
<link rel="mask-icon" href="https://l0x1c.com/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="dy a_bogus参数 逆向分析" />
<meta property="og:description" content="关于dy的a_bogus逆向，jsvmp
进行抖音抓包，对应的位置在
url = &#34;https://www.douyin.com/aweme/v1/web/aweme/post/&#34; 可以看一下调用栈，不难发现主要的逻辑在bdms_1.0.1.19_fix.js
直接跳过去可以看到d就是指令操作
先一点一点的去看
这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key
再用自定义 map 函数 _ 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC
import base64, zlib, re, hashlib, os, sys from pathlib import Path BASE64_DATA = r&#34;&#34;&#34; &#34;&#34;&#34;.strip() # ============================================== def sanitize_b64(s: str) -&gt; str: return re.sub(r&#39;[^A-Za-z0-9&#43;/=]&#39;, &#39;&#39;, s) def xor_transform(decoded: bytes) -&gt; tuple[bytes, int, int]: key_sum = sum(decoded[4:8]) &amp; 0xFFFFFFFF km = key_sum % 256 step = km % 10 tail = decoded[8:] out = bytearray(len(tail)) for i, b in enumerate(tail): out[i] = (b ^ ((km &#43; step * i) % 256)) &amp; 0xFF return bytes(out), key_sum, km def inflate_raw(data: bytes) -&gt; bytes: return zlib." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://l0x1c.com/posts/dy_web_a_bogus/" />
<meta property="og:image" content="https://l0x1c.com/images/papermod-cover.png" />
<meta property="article:section" content="posts" />
<meta property="article:published_time" content="2025-11-15T17:59:02+08:00" />
<meta property="article:modified_time" content="2025-11-15T17:59:02+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://l0x1c.com/images/papermod-cover.png" />
<meta name="twitter:title" content="dy a_bogus参数 逆向分析"/>
<meta name="twitter:description" content="关于dy的a_bogus逆向，jsvmp
进行抖音抓包，对应的位置在
url = &#34;https://www.douyin.com/aweme/v1/web/aweme/post/&#34; 可以看一下调用栈，不难发现主要的逻辑在bdms_1.0.1.19_fix.js
直接跳过去可以看到d就是指令操作
先一点一点的去看
这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key
再用自定义 map 函数 _ 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC
import base64, zlib, re, hashlib, os, sys from pathlib import Path BASE64_DATA = r&#34;&#34;&#34; &#34;&#34;&#34;.strip() # ============================================== def sanitize_b64(s: str) -&gt; str: return re.sub(r&#39;[^A-Za-z0-9&#43;/=]&#39;, &#39;&#39;, s) def xor_transform(decoded: bytes) -&gt; tuple[bytes, int, int]: key_sum = sum(decoded[4:8]) &amp; 0xFFFFFFFF km = key_sum % 256 step = km % 10 tail = decoded[8:] out = bytearray(len(tail)) for i, b in enumerate(tail): out[i] = (b ^ ((km &#43; step * i) % 256)) &amp; 0xFF return bytes(out), key_sum, km def inflate_raw(data: bytes) -&gt; bytes: return zlib."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://l0x1c.com/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "dy a_bogus参数 逆向分析",
      "item": "https://l0x1c.com/posts/dy_web_a_bogus/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "dy a_bogus参数 逆向分析",
  "name": "dy a_bogus参数 逆向分析",
  "description": "关于dy的a_bogus逆向，jsvmp\n进行抖音抓包，对应的位置在\nurl = \u0026#34;https://www.douyin.com/aweme/v1/web/aweme/post/\u0026#34; 可以看一下调用栈，不难发现主要的逻辑在bdms_1.0.1.19_fix.js\n直接跳过去可以看到d就是指令操作\n先一点一点的去看\n这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key\n再用自定义 map 函数 _ 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC\nimport base64, zlib, re, hashlib, os, sys from pathlib import Path BASE64_DATA = r\u0026#34;\u0026#34;\u0026#34; \u0026#34;\u0026#34;\u0026#34;.strip() # ============================================== def sanitize_b64(s: str) -\u0026gt; str: return re.sub(r\u0026#39;[^A-Za-z0-9+/=]\u0026#39;, \u0026#39;\u0026#39;, s) def xor_transform(decoded: bytes) -\u0026gt; tuple[bytes, int, int]: key_sum = sum(decoded[4:8]) \u0026amp; 0xFFFFFFFF km = key_sum % 256 step = km % 10 tail = decoded[8:] out = bytearray(len(tail)) for i, b in enumerate(tail): out[i] = (b ^ ((km + step * i) % 256)) \u0026amp; 0xFF return bytes(out), key_sum, km def inflate_raw(data: bytes) -\u0026gt; bytes: return zlib.",
  "keywords": [
    
  ],
  "articleBody": "关于dy的a_bogus逆向，jsvmp\n进行抖音抓包，对应的位置在\nurl = \"https://www.douyin.com/aweme/v1/web/aweme/post/\" 可以看一下调用栈，不难发现主要的逻辑在bdms_1.0.1.19_fix.js\n直接跳过去可以看到d就是指令操作\n先一点一点的去看\n这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key\n再用自定义 map 函数 _ 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC\nimport base64, zlib, re, hashlib, os, sys from pathlib import Path BASE64_DATA = r\"\"\" \"\"\".strip() # ============================================== def sanitize_b64(s: str) -\u003e str: return re.sub(r'[^A-Za-z0-9+/=]', '', s) def xor_transform(decoded: bytes) -\u003e tuple[bytes, int, int]: key_sum = sum(decoded[4:8]) \u0026 0xFFFFFFFF km = key_sum % 256 step = km % 10 tail = decoded[8:] out = bytearray(len(tail)) for i, b in enumerate(tail): out[i] = (b ^ ((km + step * i) % 256)) \u0026 0xFF return bytes(out), key_sum, km def inflate_raw(data: bytes) -\u003e bytes: return zlib.decompress(data, -15) def main(): b64 = sanitize_b64(BASE64_DATA) raw = base64.b64decode(b64) mapped = xor_transform(raw) payload = inflate_raw(mapped) out_path = Path(os.getcwd()) / \"payload.bin\" out_path.write_bytes(payload) if __name__ == \"__main__\": main() 可以和dump的东西进行对应上\nfunction W(t) { for (var r = 0, e = 0; ; ) { var n = t.d[t.i++]; if (r |= (127 \u0026 n) \u003c\u003c e, e += 7, !(128 \u0026 n)) return e \u003c 32 \u0026\u0026 64 \u0026 n ? r | -1 \u003c\u003c e : r } } 最开始的e9 07\n0xe9 = 1110 1001\n低 7 位 0x69 = 105\n0x07 = 0000 0111\n低 7 位 0x07 = 7\n累加：val += 7 \u003c\u003c 7 = 7 * 128 = 896\n总和：105 + 896 = 1001\n所以字符串池的条数为1001条\n字符串的位置走过后，这个位置是函数表对应的条数\n0x1C | 0x80 = 0x9C\n计算后这个位置应该是796条，下图调试的位置吻合\n打印出来：\n字符串表\na_bogus对应的是表的Z[220]\n调试位置对应的url的方法\n调试到这里可以看到对应的字节码的东西为\n{\"f\": [34, 54, 0, 3, 34, 30, 214, 41, 212, 34, 30, 214, 30, 70, 54, 0, 4, 74, 0, 4, 30, 218, 54, 0, 5, 74, 0, 5, 30, 72, 54, 0, 6, 33, 74, 2, 33, 74, 0, 6, 0, 1, 54, 0, 7, 74, 0, 7, 41, 5, 74, 0, 6, 53, 11, 60, 161, 74, 0, 6, 60, 216, 30, 178, 59, 2, 54, 0, 8, 74, 0, 8, 30, 162, 18, 30, 219, 73, 165, 0, 1, 29, 17, 5, 74, 2, 3, 30, 150, 41, 18, 74, 0, 8, 30, 162, 18, 30, 163, 73, 165, 74, 2, 3, 30, 150, 0, 2, 26, 74, 0, 8, 30, 162, 18, 30, 219, 73, 220, 0, 1, 29, 41, 45, 33, 74, 3, 14, 0, 0, 26, 33, 74, 2, 37, 74, 0, 8, 30, 162, 18, 30, 9, 0, 0, 74, 0, 2, 0, 2, 54, 0, 9, 74, 0, 8, 30, 162, 18, 30, 163, 73, 220, 74, 0, 9, 0, 2, 26, 74, 0, 7, 29, 41, 10, 74, 0, 5, 74, 0, 8, 30, 178, 20, 72, 34, 30, 214, 18, 30, 51, 63, 108, 0, 1, 26, 33, 74, 2, 36, 74, 0, 8, 30, 215, 0, 1, 41, 7, 33, 74, 2, 5, 0, 0, 26, 34, 73, 214, 25, 26, 74, 1, 4, 18, 30, 126, 34, 74, 0, 2, 39, 1, 0, 2, 26, 33, 76], \"i\": 1, \"u\": true, \"s\": []}, 这个序列是给\"a_bogus\"赋值的序列\n观察这个a_bogus的赋值的情况，是在var m = n.apply(d, e)中给值放到了v[p++]中，观察e的值的来源，在观察整个虚拟机，可以看到所有的v[p]都参与了基本指令运算，关于+-*/%\u0026\u003e\u003e\u003c\u003c，而且观察所有的基本运算所虚拟机表示的中的位置只有一个，那么可以思考就是对于每一个opcode，这个虚拟机只对应了简单的指令运算，然后进行大量的拼接得到的算法，所以只需要对这些基本运算进行插庄打log就可以看到整个流程的生成了\n打log的位置：所有基本运算，以及最后的放到v[++p]位置的地方\n'm:',m,'n:',n,'d:',d,'e:',e 'v[p]:',v[p] \u003e w ,'=','v[p]:',v[p],'\u003e','w:',w 'v[p]:',v[p] % E ,'=','v[p]:',v[p],'%','E:',E 'v[p]:',v[p] \u0026 E ,'=','v[p]:',v[p],'\u0026','w:',w 'v[p]:',v[p] \u003e\u003e\u003e w ,'=','v[p]:',v[p],'\u003e\u003e\u003e','w:',w 'v[p]:',v[p] - E ,'=','v[p]:',v[p],'-','E:',E 'v[p]:',v[p] \u003e\u003e w ,'=','v[p]:',v[p],'\u003e\u003e','w:',w 'v[p]:',v[p] / E ,'=','v[p]:',v[p],'/','E:',E 'v[p]:',v[p] * E ,'=','v[p]:',v[p],'*','E:',E 'v[p]:',v[p] | w ,'=','v[p]:',v[p],'|','w:',w 'v[p]:',v[p] \u003c\u003c w ,'=','v[p]:',v[p],'\u003c\u003c','w:',w 'v[p]:',v[p] + E ,'=','v[p]:',v[p],'+','E:',E 'v[p]:',v[p] ^ w ,'=','v[p]:',v[p],'^','w:',w 直接开始跑，我们从最后生成往上回溯分析\n可以看到a_bogus，这里满足base64变表，直接写个脚本测试一下\nimport random BASE_TABLE = \"Dkdpgh2ZmsQB80/MfvV36XI1R45-WUAlEixNLwoqYTOPuzKFjJnry79HbGcaStCe\" def b64_swap_decode(s: str, alphabet: str = BASE_TABLE) -\u003e bytes: table = {ch: i for i, ch in enumerate(alphabet)} s = s.strip() if len(s) % 4: s += \"=\" * ((4 - len(s) % 4) % 4) out = bytearray() for i in range(0, len(s), 4): block = s[i:i+4] pad = block.count(\"=\") vals = [] for ch in block: if ch == \"=\": vals.append(0) else: if ch not in table: raise ValueError(f\"字母表中不存在字符: {repr(ch)}\") vals.append(table[ch]) v = (vals[0] \u003c\u003c 18) | (vals[1] \u003c\u003c 12) | (vals[2] \u003c\u003c 6) | vals[3] out.append((v \u003e\u003e 16) \u0026 0xFF) if pad \u003c 2: out.append((v \u003e\u003e 8) \u0026 0xFF) if pad \u003c 1: out.append(v \u0026 0xFF) return bytes(out) def b64_swap_encode(b: bytes, alphabet: str = BASE_TABLE) -\u003e str: res = [] for i in range(0, len(b), 3): chunk = b[i:i+3] pad = 3 - len(chunk) if pad: chunk = chunk + b\"\\x00\" * pad val = (chunk[0] \u003c\u003c 16) | (chunk[1] \u003c\u003c 8) | chunk[2] res.append(alphabet[(val \u003e\u003e 18) \u0026 0x3F]) res.append(alphabet[(val \u003e\u003e 12) \u0026 0x3F]) res.append(\"=\" if pad == 2 else alphabet[(val \u003e\u003e 6) \u0026 0x3F]) res.append(\"=\" if pad \u003e= 1 else alphabet[val \u0026 0x3F]) return \"\".join(res) if __name__ == \"__main__\": encoded = \"Q6UVhHtyDdWRKVFGuCcOeJKU2Uj/rPuynlTdbzPPtBtTOq0aBSP2MnbScouJskbjL8BziKVHqEtlbDnczGU0Z99kzmpDSm4fosVCV68oZqwgTeGmLrD/ehhzuwBC0QJwl5C6NAU51sBn2jVAIq5uWd3GH5To5bEdSrZ6D/LytEAgfCSkk93kOCDdEgaFUvcG\" raw = b64_swap_decode(encoded, BASE_TABLE) print(\"Decoded bytes:\", raw) print(\"Decoded as UTF-8:\", raw.decode(\"utf-8\", errors=\"replace\")) print(\"Decimal values:\", \" \".join(str(byte) for byte in raw)) 可以看到和刚过来的数组是一样的\n在这里可以看到，这里的字符是拼接来的，前4字节和后面进行了拼接，先看一下后面的字节的来源\n追上去后可以看到两个部分的线索，直接直接就可以根据rc4的特征来看到，这部分上面是表的生成，下面是标准的rc4的算法（除了表生成位置）\n表生成位置：\n直接根据他给的写就行，写一下算法，key可以很好的看到是211\nimport random BASE_TABLE = \"Dkdpgh2ZmsQB80/MfvV36XI1R45-WUAlEixNLwoqYTOPuzKFjJnry79HbGcaStCe\" def rc4(data: bytes, key: bytes) -\u003e bytes: seed = (sum(key) \u0026 0xff) if key else 0 raw = list(range(255, -1, -1)) z = 0 n = len(raw) for i in range(n): a = (z + seed) % 256 raw[i], raw[a] = raw[a], raw[i] if i + 1 \u003c n: z = raw[i + 1] * a + a i = 0 j = 0 out = bytearray() for b in data: i = (i + 1) \u0026 0xff j = (j + raw[i]) \u0026 0xff raw[i], raw[j] = raw[j], raw[i] K = raw[(raw[i] + raw[j]) \u0026 0xff] out.append(b ^ K) return bytes(out) def b64_swap_decode(s: str, alphabet: str = BASE_TABLE) -\u003e bytes: table = {ch: i for i, ch in enumerate(alphabet)} s = s.strip() if len(s) % 4: s += \"=\" * ((4 - len(s) % 4) % 4) out = bytearray() for i in range(0, len(s), 4): block = s[i:i+4] pad = block.count(\"=\") vals = [] for ch in block: if ch == \"=\": vals.append(0) else: if ch not in table: raise ValueError(f\"字母表中不存在字符: {repr(ch)}\") vals.append(table[ch]) v = (vals[0] \u003c\u003c 18) | (vals[1] \u003c\u003c 12) | (vals[2] \u003c\u003c 6) | vals[3] out.append((v \u003e\u003e 16) \u0026 0xFF) if pad \u003c 2: out.append((v \u003e\u003e 8) \u0026 0xFF) if pad \u003c 1: out.append(v \u0026 0xFF) return bytes(out) def b64_swap_encode(b: bytes, alphabet: str = BASE_TABLE) -\u003e str: res = [] for i in range(0, len(b), 3): chunk = b[i:i+3] pad = 3 - len(chunk) if pad: chunk = chunk + b\"\\x00\" * pad val = (chunk[0] \u003c\u003c 16) | (chunk[1] \u003c\u003c 8) | chunk[2] res.append(alphabet[(val \u003e\u003e 18) \u0026 0x3F]) res.append(alphabet[(val \u003e\u003e 12) \u0026 0x3F]) res.append(\"=\" if pad == 2 else alphabet[(val \u003e\u003e 6) \u0026 0x3F]) res.append(\"=\" if pad \u003e= 1 else alphabet[val \u0026 0x3F]) return \"\".join(res) if __name__ == \"__main__\": encoded = \"Q6UVhHtyDdWRKVFGuCcOeJKU2Uj/rPuynlTdbzPPtBtTOq0aBSP2MnbScouJskbjL8BziKVHqEtlbDnczGU0Z99kzmpDSm4fosVCV68oZqwgTeGmLrD/ehhzuwBC0QJwl5C6NAU51sBn2jVAIq5uWd3GH5To5bEdSrZ6D/LytEAgfCSkk93kOCDdEgaFUvcG\" raw = b64_swap_decode(encoded, BASE_TABLE) print(\"Decoded bytes:\", raw) print(\"Decoded as UTF-8:\", raw.decode(\"utf-8\", errors=\"replace\")) print(\"Decimal values:\", \" \".join(str(byte) for byte in raw)) rc4_decoded = rc4(raw[4:], bytes([211])) print(\"RC4 Decoded bytes:\", rc4_decoded) print(\"RC4 Decoded as UTF-8:\", rc4_decoded.decode(\"utf-8\", errors=\"replace\")) print(\"RC4 Decimal values:\", \" \".join(str(byte) for byte in rc4_decoded)) RC4 Decimal values: 3 84 32 64 33 16 162 84 145 78 212 47 217 0 218 161 17 64 33 0 221 1 3 144 201 90 33 149 230 218 40 130 200 239 38 227 60 31 8 2 65 66 51 156 107 4 20 27 128 0 206 12 194 64 44 16 155 97 185 240 16 67 40 0 144 43 208 32 107 108 40 17 148 2 29 32 165 113 26 49 253 55 27 54 178 126 17 112 52 113 22 49 236 120 57 56 34 62 49 113 36 49 54 49 124 122 25 56 35 62 53 113 53 113 30 49 108 121 48 56 179 124 105 92 224 35 105 75 255 54 73 100 125 50 52 38 164 110 183 29 rc4这个位置是没有错的，继续往下分析\n前面四个字节的来源，前四个字节是41 71 82 23看一下来源\ndef gen_s() -\u003e str: # a = (int(random.random() * 65535)) \u0026 0xFF # b = int(random.random() * 40) a = (int(0.5446416885859573 * 65535)) \u0026 0xFF b = int(0.5832301287563609 * 40) s = [] s.append(chr((a \u0026 0xAA) | 0x01)) s.append(chr((a \u0026 0x55) | 0x02)) s.append(chr((b \u0026 0xAA) | 0x50)) s.append(chr((b \u0026 0x55) | 0x02)) return ''.join(s) #Generated 4 bytes: b')GR\\x17' #Generated Decimal values: 41 71 82 23 再往上追可以看到，这个刚才rc4解密的数组是通过8为数组+132位数组来的\n第一组的地方3, 84, 32, 64\n第二组的地方33, 16, 162, 84\ndef gen_r_head2() -\u003e str: # a= (int(random.random() * 240)) \u0026 0xFF # b = (int(random.random() * 255)) \u0026 0xFF \u0026 77 a = (int(0.20071909122733345 * 240)) \u0026 0xFF b = (int(0.83287578221808 * 255)) \u0026 0xFF \u0026 77 w = [1, 4, 5, 7] for i in range(4): b = b | (1 \u003c\u003c w[i]); s = [] s.append(chr((a \u0026 0xAA) | 0x1)) s.append(chr((a \u0026 0x55) | 0x0)) s.append(chr((b \u0026 0xAA) | 0x0)) s.append(chr((b \u0026 0x55) | 0x0)) return ''.join(s) 对应8字节后面的四位33, 16, 162, 84\ndef gen_r_head1() -\u003e str: # z = int(random.random() * 65535) # a = z \u0026 0xFF # b = (z \u003e\u003e 8) \u0026 0xFF a = (int(0.37632919615333793 * 65535)) \u0026 0xFF b = (int(0.37632919615333793 * 65535) \u003e\u003e 8) \u0026 0xFF s = [] s.append(chr((a \u0026 0xAA) | 0x1)) s.append(chr((a \u0026 0x55) | 0x0)) s.append(chr((b \u0026 0xAA) | 0x0)) s.append(chr((b \u0026 0x55) | 0x0)) return ''.join(s) Length of gen: 8 Generated r_head Decimal values: 3 84 32 64 33 16 162 84 正好对应上了\n网上回溯看一下这个是怎么生成的，这个时候可以看到这里面永远都会一组重复的数字145, 110, 66, 189, 44, 211\n根据上面可以写出加密逻辑\nimport random key = [145, 110, 66, 189, 44, 211] data = [1,14,252,201,0,242,0,0,1,220,1,3,217,24,5,230,154,0,201,239,34,44,31,0,208,0,31,123,6,24,0,0,206,82,0,0,154,97,177,0,1,0,0,41,240,123,44,0,4,0,49,53,49,50,124,55,55,50,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,57,56,50,124,77,97,99,73,110,116,101,108,50,52,53,44,159] result = [] rad = [0.21538688661648553,0.9212125883092179,0.11329993696990215,0.4012867884874777,0.7397694321593413,0.2345646507296566,0.48677241706302965,0.02660945354489941,0.3556811964939194,0.7736328373701941,0.6529429229670689,0.4924646761384377,0.7613914142703988,0.3780540061140839,0.9141587354910575,0.10551554793573337,0.15838251707991813,0.7137565040911108,0.4114927013372691,0.21053933074769915,0.5965956170259822,0.23215038617850303,0.2901816263862327,0.29295876428660983,0.6021625523305605,0.039574963495331406,0.6054109386072396,0.09645229970364944,0.5053147091841774,0.938315440828625,0.41117788486726015,0.05572314150793589,0.9985371346724156] for i in range(0, len(data), 3): #v = (int(random.random() * 1000)) \u0026 0xFF v = (int(rad[i // 3] * 1000)) \u0026 0xFF result.append(chr((v \u0026 key[0]) | (data[i] \u0026 key[1]))) result.append(chr((v \u0026 key[2]) | (data[i + 1] \u0026 key[3]))) result.append(chr((v \u0026 key[4]) | (data[i + 2] \u0026 key[5]))) result.append(chr((data[i] \u0026 key[0]) | (data[i + 1] \u0026 key[2]) | (data[i + 2] \u0026 key[4]))) data_result = ''.join(result).encode(\"latin-1\") print(data_result) print(\"values:\", \" \".join(str(byte) for byte in data_result)) 同理解密逻辑为\ndef decode_data(data) -\u003e str: key = [145, 110, 66, 189, 44, 211] out = [] for i in range(0, len(data), 4): r0, r1, r2, r3 = data[i:i+4] a = (r0 \u0026 key[1]) | (r3 \u0026 key[0]) b = (r1 \u0026 key[3]) | (r3 \u0026 key[2]) c = (r2 \u0026 key[5]) | (r3 \u0026 key[4]) out.extend([a, b, c]) return bytes(out) 对应了：\n[1,14,252,201,0,242,0,0,1,220,1,3,217,24,5,230,154,0,201,239,34,44,31,0,208,0,31,123,6,24,0,0,206,82,0,0,154,97,177,0,1,0,0,41,240,123,44,0,4,0,49,53,49,50,124,55,55,50,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,57,56,50,124,77,97,99,73,110,116,101,108,50,52,53,44,159 ] 继续往上根\n他把刚才的这些数据进行了分组\n[1,14,252,201,0,242,0,0,1,220,1,3,217,24,5,230,154,0,201,239,34,44,31,0,208,0,31,123,6,24,0,0,206,82,0,0,154,97,177,0,1,0,0,41,240,123,44,0,4,0] [49,53,49,50,124,55,55,50,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,57,56,50,124,77,97,99,73,110,116,101,108] [50,52,53,44] [159] 中间的第二组，从刚才的解密结果可以发现，这个数组是一些可能带有的参数\n1512|772|1512|893|1512|893|1512|982|MacIntel% 那么剩下关心的就是剩下的这几组的参数了\n四位的情况向上回溯，和时间戳有关系\n可以看到最后的那个单个的数字159是经过很多次的xor得到的\n如果你的记忆里很好的话，看到这里的时候你就一定会知道这些东西你见过，就是之前那个随机的8位数\nGenerated r_head Decimal values: 3 84 32 64 33 16 162 84\n这个时候就会疑问这个41后面的都是哪里来的，重新trace看一下对应的位置\nXor 41索引位置24\n依次把x都拿出来，就可以得到索引\n[24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 52, 53, 55, 56, 57, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 79, 80, 84, 85] 写代码实现就是\nw = [24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 52, 53, 55, 56, 57, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 79, 80, 84, 85] w_8 = [169, 21, 136, 81, 137, 81, 162, 21] table_gobal = [ [ { \"5\": { \"aid\": 6383, \"pageId\": 6241, \"boe\": 0, \"ddrt\": 8.5, \"paths\": { \"include\": [ {}, {}, {}, {}, {}, {}, {}, {} ], \"exclude\": [ {} ] }, \"track\": { \"mode\": 0, \"delay\": 300, \"paths\": [] }, \"slU\": \"\", \"dump\": 1, \"rpU\": \"\", \"ic\": 8.5 } }, {}, \"dhzx\", 1763021788706, 5, { \"name\": \"Chrome\" }, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0 ], { \"0\": 1, \"1\": 0, \"2\": 8, \"3\": \"device_platform=webapp\u0026aid=6383\u0026channel=channel_pc_web\u0026sec_user_id=MS4wLjABAAAAofq0Vvn8ISgdgZ-eX4lgGoJb1BQDtjB3K7I8XzjTfW3hMgZ9gaaJnYy-Er1k5QRi\u0026max_cursor=0\u0026locate_query=false\u0026show_live_replay_strategy=1\u0026need_time_list=1\u0026time_list_query=0\u0026whale_cut_token=\u0026cut_version=1\u0026count=18\u0026publish_video_strategy_type=2\u0026from_user_page=1\u0026update_version_code=170400\u0026pc_client_type=1\u0026pc_libra_divert=Mac\u0026support_h265=1\u0026support_dash=1\u0026cpu_core_num=10\u0026version_code=290100\u0026version_name=29.1.0\u0026cookie_enabled=true\u0026screen_width=1512\u0026screen_height=982\u0026browser_language=zh-CN\u0026browser_platform=MacIntel\u0026browser_name=Chrome\u0026browser_version=142.0.0.0\u0026browser_online=true\u0026engine_name=Blink\u0026engine_version=142.0.0.0\u0026os_name=Mac+OS\u0026os_version=10.15.7\u0026device_memory=8\u0026platform=PC\u0026downlink=10\u0026effective_type=4g\u0026round_trip_time=50\u0026webid=7537255736499029513\u0026uifid=ecb38e5e86f1f8799c3256ca6c3446710d152cd7b76a2f92ca888d379e861b9ef6c3c057199fbabeb251493a65cd070d26b3aeca82ccc95af03dc3a8930e7db657234d4ca4acb8174f8b9e3cab43ff6260ae432fd24dfe6de26ecc544bf0426c0fb819444e48099c31f99143dab6d5c48975b8b37a257b159ef2fe6dacc5252904813ff4b25bebd8458d1565ef36ce45b9144f443029919505f73dca564bcd4a\u0026msToken=_ldHApyvIwdTTeKAtEdJ420xs1ltIcgsNMzR0bX8PJ5sv86p7ORbTipL0ylgxU3ZmrrxoR-Rv6qwyig0-yZPE26FFFIFwRgTGONu1NN5FlswqC5B2WRWvp3ESGTQNFgQOgIor-bnh8BYHfUnAyQGwl_VuKgrY2s_WeRVHHN4nLRd1nxcNjjF-A%3D%3D\", \"4\": \"\", \"5\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\", \"6\": 6241, \"7\": 6383, \"8\": \"1.0.1.19-fix.01\" }, 1, 0, 8, \"device_platform=webapp\u0026aid=6383\u0026channel=channel_pc_web\u0026sec_user_id=MS4wLjABAAAAofq0Vvn8ISgdgZ-eX4lgGoJb1BQDtjB3K7I8XzjTfW3hMgZ9gaaJnYy-Er1k5QRi\u0026max_cursor=0\u0026locate_query=false\u0026show_live_replay_strategy=1\u0026need_time_list=1\u0026time_list_query=0\u0026whale_cut_token=\u0026cut_version=1\u0026count=18\u0026publish_video_strategy_type=2\u0026from_user_page=1\u0026update_version_code=170400\u0026pc_client_type=1\u0026pc_libra_divert=Mac\u0026support_h265=1\u0026support_dash=1\u0026cpu_core_num=10\u0026version_code=290100\u0026version_name=29.1.0\u0026cookie_enabled=true\u0026screen_width=1512\u0026screen_height=982\u0026browser_language=zh-CN\u0026browser_platform=MacIntel\u0026browser_name=Chrome\u0026browser_version=142.0.0.0\u0026browser_online=true\u0026engine_name=Blink\u0026engine_version=142.0.0.0\u0026os_name=Mac+OS\u0026os_version=10.15.7\u0026device_memory=8\u0026platform=PC\u0026downlink=10\u0026effective_type=4g\u0026round_trip_time=50\u0026webid=7537255736499029513\u0026uifid=ecb38e5e86f1f8799c3256ca6c3446710d152cd7b76a2f92ca888d379e861b9ef6c3c057199fbabeb251493a65cd070d26b3aeca82ccc95af03dc3a8930e7db657234d4ca4acb8174f8b9e3cab43ff6260ae432fd24dfe6de26ecc544bf0426c0fb819444e48099c31f99143dab6d5c48975b8b37a257b159ef2fe6dacc5252904813ff4b25bebd8458d1565ef36ce45b9144f443029919505f73dca564bcd4a\u0026msToken=_ldHApyvIwdTTeKAtEdJ420xs1ltIcgsNMzR0bX8PJ5sv86p7ORbTipL0ylgxU3ZmrrxoR-Rv6qwyig0-yZPE26FFFIFwRgTGONu1NN5FlswqC5B2WRWvp3ESGTQNFgQOgIor-bnh8BYHfUnAyQGwl_VuKgrY2s_WeRVHHN4nLRd1nxcNjjF-A%3D%3D\", \"\", \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\", 6241, 6383, \"1.0.1.19-fix.01\", { \"ink\": 1763021788706 }, 3, { \"value\": \"0X21\", \"writable\": 0, \"enumerable\": 1, \"configurable\": 1 }, 1763021788708, { \"reg\": [ 1937774191, 1226093241, 388252375, 3666478592, 2842636476, 372324522, 3817729613, 2969243214 ], \"chunk\": [], \"size\": 0 }, 1, 14, [ 75, 88, 25, 204, 46, 136, 235, 122, 51, 23, 207, 160, 3, 48, 143, 135, 1, 25, 54, 194, 0, 108, 224, 238, 26, 252, 36, 188, 147, 131, 240, 57 ], [ 64, 253, 156, 240, 44, 96, 159, 150, 27, 122, 82, 52, 197, 120, 234, 119, 245, 89, 71, 177, 99, 98, 28, 142, 5, 99, 123, 199, 176, 9, 152, 240 ], \"eWgvhqF7obsvc6EpmziycV7XL8a0cgI1T8jgTKeNbjPeaKF1gvtiAPTEZavZAo08AIP6CdZALC6EbNqevfpUebcct0j7VPPDkRfsBmBXxwdsjBBMnjZ8biljt0Eg1OEzGvPt3LjptJUTYvu+JLsMBZ6mXcXV\", [ 34, 2, 135, 211, 192, 208, 65, 120, 79, 137, 215, 252, 68, 7, 137, 60, 10, 133, 247, 147, 234, 206, 193, 40, 81, 115, 135, 232, 128, 141, 33, 199 ], 1763021788706, [ 3, 82 ], 41, [ 1, 0, 1, 0, 1 ], 34, 6, 5, 36, 150, 73, 124, 154, 1, 1, 0, [ 0, 0, 0, 0, 1 ], 1, 0, 0, 0, 0, 0, 14, 0, 0, 0, 23, 54, 3, 204, 82, 177, 4, 44, 252, 206, 5, 208, 34, 150, 73, 124, 154, 1, 3, 97, 24, 0, 0, 239, 24, 0, 0, { \"innerWidth\": 1512, \"innerHeight\": 772, \"outerWidth\": 1512, \"outerHeight\": 893, \"availWidth\": 1512, \"availHeight\": 893, \"sizeWidth\": 1512, \"sizeHeight\": 982, \"platform\": \"MacIntel\" }, \"1512|772|1512|893|1512|893|1512|982|MacIntel\", [ 49, 53, 49, 50, 124, 55, 55, 50, 124, 49, 53, 49, 50, 124, 56, 57, 51, 124, 49, 53, 49, 50, 124, 56, 57, 51, 124, 49, 53, 49, 50, 124, 57, 56, 50, 124, 77, 97, 99, 73, 110, 116, 101, 108 ], 44, 44, 0, \"39,\", [ 51, 57, 44 ], 3, 3, 0, [ 169, 21, 136, 81, 137, 81, 162, 21 ], 104, [ 1, 14, 252, 150, 0, 36, 0, 0, 1, 54, 1, 3, 204, 24, 5, 23, 154, 0, 150, 239, 34, 44, 73, 0, 208, 0, 73, 124, 6, 24, 0, 0, 206, 82, 0, 0, 154, 97, 177, 0, 1, 0, 0, 41, 34, 124, 44, 0, 3, 0, 49, 53, 49, 50, 124, 55, 55, 50, 124, 49, 53, 49, 50, 124, 56, 57, 51, 124, 49, 53, 49, 50, 124, 56, 57, 51, 124, 49, 53, 49, 50, 124, 57, 56, 50, 124, 77, 97, 99, 73, 110, 116, 101, 108, 51, 57, 44, 104 ], \"\\u000b\\u0003r\\u0007\", [ 128, 12, 216, 47, 150, 2, 40, 180, 0, 0, 9, 0, 55, 3, 7, 16, 220, 90, 1, 132, 150, 216, 40, 19, 134, 173, 42, 242, 44, 11, 40, 64, 208, 0, 97, 152, 236, 70, 28, 26, 128, 0, 194, 12, 67, 0, 36, 16, 155, 33, 145, 240, 1, 3, 40, 0, 129, 107, 38, 32, 108, 44, 32, 16, 2, 66, 21, 33, 164, 51, 62, 49, 237, 55, 63, 54, 50, 126, 29, 112, 165, 115, 50, 49, 252, 120, 49, 56, 51, 124, 29, 113, 53, 51, 26, 49, 124, 122, 29, 56, 178, 60, 21, 113, 37, 115, 50, 49, 236, 121, 20, 56, 35, 62, 65, 92, 113, 99, 69, 75, 239, 54, 97, 100, 253, 115, 25, 42, 44, 104 ], \"Õ5¨6°ø+¸¢¬¦ÿTëÉ\\u001f4#øFbÏëÔ®\\u0019¨sêaÊ.\u003e(Ê) fL4\\u0017åä·\\u000fÞ \\u0004º·×e\\u001f|Á´Ñ°pPÔ¶HÕf\\u0016xEåÚH0*üÑm¾Ro6em¯ö\\u0018pã\\u0019(Zv¨pµûýªvi¤\\u0002s1ð\\u0000yvÞ\\u0007\\u0015\\u0003Ã\\u0001\\u0017dé«`C­Bgs\", \"\\u000b\\u0003r\\u0007Õ5¨6°ø+¸¢¬¦ÿTëÉ\\u001f4#øFbÏëÔ®\\u0019¨sêaÊ.\u003e(Ê) fL4\\u0017åä·\\u000fÞ \\u0004º·×e\\u001f|Á´Ñ°pPÔ¶HÕf\\u0016xEåÚH0*üÑm¾Ro6em¯ö\\u0018pã\\u0019(Zv¨pµûýªvi¤\\u0002s1ð\\u0000yvÞ\\u0007\\u0015\\u0003Ã\\u0001\\u0017dé«`C­Bgs\", \"dj0nkt67Op5jCdKbYOnoe7VlcSLlNT8ymei2RueP7Qb4OZMORRNQBNbYnxoE4LjyhbpwiCVHLEeAYDVcztUwZHrkzmpvuZkfqtV9V0XohqihGUTmErDOe0hzFwsF0Yiw-5CWNlRRWsBN2VxAIq5YWB1ae5T955fdWrZjDZw9HEWXDS8kh93TO9kpP6sqWj==\" ] key = [] key = w_8 for i in range(len(w)): key.append(table_gobal[w[i]]) s = key[0] for i in range(1, len(key)): s = s ^ key[i] print(\"s:\", s) 可以对应上\n同理上面如果继续看的还会看到一个表\n[34, 44, 56, 61, 73, 29, 70, 45, 35, 49, 38, 66, 51, 68, 28, 48, 64, 47, 30, 71, 26, 55, 31, 69, 59, 40, 62, 63, 27, 72, 41, 74, 57, 52, 42, 39, 33, 67, 53, 43, 65, 46, 36, 24, 60, 32, 79, 80, 84, 85] 这个就是50位生成的地方，可以看到可以很完美的对应上\n继续向上看的话，可以看一个新的值\n这个位置对应了刚才分析到拿出来参数的这个位置\n可以很好的看出来这是一个sm3加密算法\n这个位置和js的某一个地方的源码一样，key = sum\n那么参数应该就是那个加密后的base64字符串\ndef sm3_hex(s: str) -\u003e str: def rol(x, n): return ((x \u003c\u003c n) | (x \u003e\u003e (32 - n))) \u0026 0xFFFFFFFF def P0(x): return x ^ rol(x, 9) ^ rol(x, 17) def P1(x): return x ^ rol(x, 15) ^ rol(x, 23) V = [ 0x7380166F, 0x4914B2B9, 0x172442D7, 0xDA8A0600, 0xA96F30BC, 0x163138AA, 0xE38DEE4D, 0xB0FB0E4E, ] m = bytearray(s.encode(\"utf-8\")) bitlen = (len(m) * 8) \u0026 ((1 \u003c\u003c 64) - 1) m.append(0x80) while (len(m) + 8) % 64 != 0: m.append(0x00) m += bitlen.to_bytes(8, \"big\") for off in range(0, len(m), 64): B = m[off:off+64] W = [int.from_bytes(B[i*4:i*4+4], \"big\") for i in range(16)] + [0]*52 for i in range(16, 68): W[i] = (P1(W[i-16] ^ W[i-9] ^ rol(W[i-3], 15)) ^ rol(W[i-13], 7) ^ W[i-6]) \u0026 0xFFFFFFFF W1 = [(W[i] ^ W[i+4]) \u0026 0xFFFFFFFF for i in range(64)] A,Bb,C,D,E,F,G,H = V for j in range(64): T = 0x79CC4519 if j \u003c= 15 else 0x7A879D8A SS1 = rol((rol(A,12) + E + rol(T, j \u0026 31)) \u0026 0xFFFFFFFF, 7) SS2 = SS1 ^ rol(A,12) FF = (A ^ Bb ^ C) if j \u003c= 15 else ((A \u0026 Bb) | (A \u0026 C) | (Bb \u0026 C)) GG = (E ^ F ^ G) if j \u003c= 15 else ((E \u0026 F) | ((~E) \u0026 G)) TT1 = (FF + D + SS2 + W1[j]) \u0026 0xFFFFFFFF TT2 = (GG + H + SS1 + W[j]) \u0026 0xFFFFFFFF D, C, Bb, A = C, rol(Bb, 9), A, TT1 H, G, F, E = G, rol(F, 19), E, P0(TT2) V = [(V[0]^A)\u00260xFFFFFFFF, (V[1]^Bb)\u00260xFFFFFFFF, (V[2]^C)\u00260xFFFFFFFF, (V[3]^D)\u00260xFFFFFFFF, (V[4]^E)\u00260xFFFFFFFF, (V[5]^F)\u00260xFFFFFFFF, (V[6]^G)\u00260xFFFFFFFF, (V[7]^H)\u00260xFFFFFFFF] return \"\".join(f\"{x:08x}\" for x in V) if __name__ == \"__main__\": s = \"eWgvhqF7obsvc6EpmziycV7XL8a0cgI1T8jgTKeNbjPeaKF1gvtiAPTEZavZAo08AIP6CdZALC6EbNqevfpUebcct0j7VPPDkRfsBmBXxwdsjBBMnjZ8biljt0Eg1OEzGvPt3LjptJUTYvu+JLsMBZ6mXcXV\" dec_s = sm3_hex(s) print(\"SM3 Hash:\", dec_s) print(\"values:\", \" \".join(str(int(dec_s[i:i+2], 16)) for i in range(0, len(dec_s), 2))) 34 2 135 211 192 208 65 120 79 137 215 252 68 7 137 60 10 133 247 147 234 206 193 40 81 115 135 232 128 141 33 199 和加密位置吻合\n这上面生成的还是之前那个base64变表，只是table换成了：ckdp1h4ZKsUB80/Mfvw36XIgR25+WQAlEi7NLboqYTOPuzmFjJnryx9HVGDaStCe\n再往上看就是rc4的变种\n不过很奇怪，这个console的问题复制的变化后的表，不过可以通过输入和输出反推s盒\ndef rc4_reverse_initial_s(plaintext: bytes, ciphertext: list[int], s_final: list[int]) -\u003e list[int]: assert len(plaintext) == len(ciphertext) K = [p ^ c for p, c in zip(plaintext, ciphertext)] N = len(K) S = s_final.copy() for r in range(N, 0, -1): i = r \u0026 0xFF kbyte = K[r-1] q = S.index(kbyte) val = (q - S[i]) \u0026 0xFF j = S.index(val) S[i], S[j] = S[j], S[i] return S p = b\"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\" c = [140,165,135,67,153,198,40,136,15,88,221,45,145,102,31,34,14,215,234,84,3,223,159,233, 21,43,30,231,92,190,76,138,7,196,171,154,89,46,118,89,242,253,199,34,54,46,101,113, 255,123,71,91,175,154,109,84,114,32,41,141,138,157,195,176,120,7,236,228,14,186,87, 175,153,105,244,128,158,187,60,242,102,168,43,233,122,180,166,124,195,121,110,230, 176,224,84,14,205,14,120,149,190,185,143,127,188,19,174,63,202,187,28] s_final = [110,11,105,14,79,174,199,147,251,20,88,215,152,179,85,128,74,18,80,163,155,195,197,176,246,145,208,172,144,114,48,148,16,90,180,118,154,96,245,139,34,84,162,229,39,193,243,108,240,42,0,9,221,87,106,70,81,29,31,189,102,164,55,219,157,64,30,38,109,196,142,183,236,217,228,115,224,182,177,123,86,125,213,140,233,175,36,51,111,22,10,250,78,222,7,127,46,137,171,104,97,158,43,225,204,3,93,166,146,67,178,63,198,89,57,23,254,242,239,207,192,150,45,44,40,59,17,65,237,223,132,37,253,50,238,188,21,100,230,226,200,27,28,248,99,116,13,247,165,1,210,249,131,206,107,138,161,191,168,26,141,194,186,143,4,72,202,68,135,56,83,218,98,190,117,227,15,201,12,173,235,205,69,77,120,209,61,129,231,181,241,60,41,66,214,119,94,8,71,82,76,62,6,75,167,112,25,95,156,19,160,151,159,122,47,136,134,24,203,73,92,58,121,113,187,32,211,153,101,126,54,130,252,91,220,35,234,2,149,52,232,216,5,244,124,184,169,33,170,255,49,103,53,133,185,212] s_initial = rc4_reverse_initial_s(p, c, s_final) print(s_initial) [110, 89, 245, 118, 200, 160, 49, 72, 67, 201, 108, 116, 250, 208, 8, 68, 126, 125, 165, 214, 55, 40, 217, 42, 66, 221, 189, 22, 123, 88, 122, 249, 159, 204, 198, 94, 163, 74, 105, 242, 87, 172, 252, 243, 174, 146, 206, 225, 43, 65, 229, 169, 168, 148, 248, 196, 247, 153, 150, 226, 48, 84, 240, 162, 139, 59, 157, 164, 31, 129, 52, 80, 103, 161, 81, 237, 75, 0, 177, 234, 219, 186, 223, 70, 155, 197, 37, 180, 246, 11, 56, 46, 62, 199, 86, 10, 179, 251, 181, 85, 193, 83, 97, 166, 141, 4, 230, 154, 51, 7, 36, 30, 233, 38, 57, 23, 254, 63, 239, 207, 192, 109, 45, 44, 195, 64, 17, 176, 115, 213, 132, 178, 253, 50, 238, 188, 21, 100, 93, 152, 79, 27, 28, 106, 99, 215, 13, 228, 183, 1, 210, 34, 131, 182, 107, 138, 175, 191, 145, 26, 90, 194, 18, 143, 3, 147, 202, 128, 135, 127, 158, 218, 98, 190, 117, 227, 15, 20, 12, 173, 235, 205, 69, 77, 120, 209, 61, 140, 231, 171, 241, 60, 41, 111, 114, 119, 14, 104, 71, 82, 76, 78, 6, 224, 167, 112, 25, 95, 156, 19, 39, 151, 16, 102, 47, 136, 134, 24, 203, 73, 92, 58, 121, 113, 187, 32, 211, 29, 101, 96, 54, 130, 137, 91, 220, 35, 144, 2, 149, 142, 232, 216, 5, 244, 124, 184, 9, 33, 170, 255, 222, 236, 53, 133, 185, 212] 加密逻辑：\nimport random BASE_TABLE = \"ckdp1h4ZKsUB80/Mfvw36XIgR25+WQAlEi7NLboqYTOPuzmFjJnryx9HVGDaStCe\" def b64_swap_decode(s: str, alphabet: str = BASE_TABLE) -\u003e bytes: table = {ch: i for i, ch in enumerate(alphabet)} s = s.strip() if len(s) % 4: s += \"=\" * ((4 - len(s) % 4) % 4) out = bytearray() for i in range(0, len(s), 4): block = s[i:i+4] pad = block.count(\"=\") vals = [] for ch in block: if ch == \"=\": vals.append(0) else: if ch not in table: raise ValueError(f\"字母表中不存在字符: {repr(ch)}\") vals.append(table[ch]) v = (vals[0] \u003c\u003c 18) | (vals[1] \u003c\u003c 12) | (vals[2] \u003c\u003c 6) | vals[3] out.append((v \u003e\u003e 16) \u0026 0xFF) if pad \u003c 2: out.append((v \u003e\u003e 8) \u0026 0xFF) if pad \u003c 1: out.append(v \u0026 0xFF) return bytes(out) def b64_swap_encode(b: bytes, alphabet: str = BASE_TABLE) -\u003e str: res = [] for i in range(0, len(b), 3): chunk = b[i:i+3] pad = 3 - len(chunk) if pad: chunk = chunk + b\"\\x00\" * pad val = (chunk[0] \u003c\u003c 16) | (chunk[1] \u003c\u003c 8) | chunk[2] res.append(alphabet[(val \u003e\u003e 18) \u0026 0x3F]) res.append(alphabet[(val \u003e\u003e 12) \u0026 0x3F]) res.append(\"=\" if pad == 2 else alphabet[(val \u003e\u003e 6) \u0026 0x3F]) res.append(\"=\" if pad \u003e= 1 else alphabet[val \u0026 0x3F]) return \"\".join(res) def sm3_hex(s: str) -\u003e str: def rol(x, n): return ((x \u003c\u003c n) | (x \u003e\u003e (32 - n))) \u0026 0xFFFFFFFF def P0(x): return x ^ rol(x, 9) ^ rol(x, 17) def P1(x): return x ^ rol(x, 15) ^ rol(x, 23) V = [ 0x7380166F, 0x4914B2B9, 0x172442D7, 0xDA8A0600, 0xA96F30BC, 0x163138AA, 0xE38DEE4D, 0xB0FB0E4E, ] m = bytearray(s.encode(\"utf-8\")) bitlen = (len(m) * 8) \u0026 ((1 \u003c\u003c 64) - 1) m.append(0x80) while (len(m) + 8) % 64 != 0: m.append(0x00) m += bitlen.to_bytes(8, \"big\") for off in range(0, len(m), 64): B = m[off:off+64] W = [int.from_bytes(B[i*4:i*4+4], \"big\") for i in range(16)] + [0]*52 for i in range(16, 68): W[i] = (P1(W[i-16] ^ W[i-9] ^ rol(W[i-3], 15)) ^ rol(W[i-13], 7) ^ W[i-6]) \u0026 0xFFFFFFFF W1 = [(W[i] ^ W[i+4]) \u0026 0xFFFFFFFF for i in range(64)] A,Bb,C,D,E,F,G,H = V for j in range(64): T = 0x79CC4519 if j \u003c= 15 else 0x7A879D8A SS1 = rol((rol(A,12) + E + rol(T, j \u0026 31)) \u0026 0xFFFFFFFF, 7) SS2 = SS1 ^ rol(A,12) FF = (A ^ Bb ^ C) if j \u003c= 15 else ((A \u0026 Bb) | (A \u0026 C) | (Bb \u0026 C)) GG = (E ^ F ^ G) if j \u003c= 15 else ((E \u0026 F) | ((~E) \u0026 G)) TT1 = (FF + D + SS2 + W1[j]) \u0026 0xFFFFFFFF TT2 = (GG + H + SS1 + W[j]) \u0026 0xFFFFFFFF D, C, Bb, A = C, rol(Bb, 9), A, TT1 H, G, F, E = G, rol(F, 19), E, P0(TT2) V = [(V[0]^A)\u00260xFFFFFFFF, (V[1]^Bb)\u00260xFFFFFFFF, (V[2]^C)\u00260xFFFFFFFF, (V[3]^D)\u00260xFFFFFFFF, (V[4]^E)\u00260xFFFFFFFF, (V[5]^F)\u00260xFFFFFFFF, (V[6]^G)\u00260xFFFFFFFF, (V[7]^H)\u00260xFFFFFFFF] return \"\".join(f\"{x:08x}\" for x in V) def rc4_2(data: bytes) -\u003e bytes: table = [110,89,245,118,200,160,49,72,67,201,108,116,250,208,8,68,126,125,165,214,55,40,217,42,66,221,189,22,123,88,122,249,159,204,198,94,163,74,105,242,87,172,252,243,174,146,206,225,43,65,229,169,168,148,248,196,247,153,150,226,48,84,240,162,139,59,157,164,31,129,52,80,103,161,81,237,75,0,177,234,219,186,223,70,155,197,37,180,246,11,56,46,62,199,86,10,179,251,181,85,193,83,97,166,141,4,230,154,51,7,36,30,233,38,57,23,254,63,239,207,192,109,45,44,195,64,17,176,115,213,132,178,253,50,238,188,21,100,93,152,79,27,28,106,99,215,13,228,183,1,210,34,131,182,107,138,175,191,145,26,90,194,18,143,3,147,202,128,135,127,158,218,98,190,117,227,15,20,12,173,235,205,69,77,120,209,61,140,231,171,241,60,41,111,114,119,14,104,71,82,76,78,6,224,167,112,25,95,156,19,39,151,16,102,47,136,134,24,203,73,92,58,121,113,187,32,211,29,101,96,54,130,137,91,220,35,144,2,149,142,232,216,5,244,124,184,9,33,170,255,222,236,53,133,185,212] out = bytearray() i = 0 j = 0 for b in data: i = (i + 1) % 256 j = (j + table[i]) % 256 table[i], table[j] = table[j], table[i] K = table[(table[i] + table[j]) % 256] out.append(b ^ K) return bytes(out) if __name__ == \"__main__\": data = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36\" rc4_encoded = rc4_2(data.encode(\"utf-8\")) print(\"RC4 Encoded bytes:\", rc4_encoded) decoded_data = b64_swap_encode(rc4_encoded) print(\"Encoded string:\", decoded_data) sm3_data = sm3_hex(decoded_data) print(\"SM3 Hash:\", sm3_data) print(\"SM3 Decimal values:\", \" \".join(str(int(sm3_data[i:i+2], 16)) for i in range(0, len(sm3_data), 2))) 这里是UA进行加密\n再刷新一下，发现这个rc4的表是会变的，那就说明这个表的key是每一次不一样的，看一下为什么\n这里应该是索引：[0.00390625, 1, 14]\n这个第一个应该是固定的，可以很明显的看出来是1/256 = 0.00390625\ndef rc4_2(data: bytes) -\u003e bytes: r = [] k = 0 y = [0, 1, 14] for i in range(255, -1, -1): r.append(i) for i in range(len(r)): a = r[i] k = (k * a + k + y[i % 3]) % 256 b = r[k] r[i], r[k] = b, a table = r out = bytearray() i = 0 j = 0 for b in data: i = (i + 1) % 256 j = (j + table[i]) % 256 table[i], table[j] = table[j], table[i] K = table[(table[i] + table[j]) % 256] out.append(b ^ K) return bytes(out) 这样表就可以生成了\n后面就没可以逆的算法了，都是sm3，请求参数拼接一个dhzx进行两次sm3，再对dhzx单独做两次sm3\n修改sm3函数\ndef enc_sum(n_str: str, as_hex: bool = False): def rotl(x, n): n \u0026= 31 return ((x \u003c\u003c n) | (x \u003e\u003e (32 - n))) \u0026 0xffffffff def Tj(j): if 0 \u003c= j \u003c 16: return 0x79cc4519 # 2043430169 elif 16 \u003c= j \u003c 64: return 0x7a879d8a # 2055708042 else: raise ValueError(\"invalid j for Tj\") def FF(j, x, y, z): if 0 \u003c= j \u003c 16: return (x ^ y ^ z) \u0026 0xffffffff elif 16 \u003c= j \u003c 64: return ((x \u0026 y) | (x \u0026 z) | (y \u0026 z)) \u0026 0xffffffff else: raise ValueError(\"invalid j for FF\") def GG(j, x, y, z): if 0 \u003c= j \u003c 16: return (x ^ y ^ z) \u0026 0xffffffff elif 16 \u003c= j \u003c 64: return ((x \u0026 y) | (~x \u0026 z)) \u0026 0xffffffff else: raise ValueError(\"invalid j for GG\") class SM3: def __init__(self): self.reg = [0] * 8 self.chunk = bytearray() self.size = 0 self.reset() def reset(self): self.reg[0] = 0x7380166f # 1937774191 self.reg[1] = 0x4914b2b9 # 1226093241 self.reg[2] = 0x172442d7 # 388252375 self.reg[3] = 0xda8a0600 # 3666478592 self.reg[4] = 0xa96f30bc # 2842636476 self.reg[5] = 0x163138aa # 372324522 self.reg[6] = 0xe38dee4d # 3817729613 self.reg[7] = 0xb0fb0e4e # 2969243214 self.chunk = bytearray() self.size = 0 def write(self, data): if isinstance(data, str): bs = data.encode(\"utf-8\") elif isinstance(data, (bytes, bytearray)): bs = bytes(data) else: bs = bytes(int(b) \u0026 0xff for b in data) self.size += len(bs) self.chunk.extend(bs) while len(self.chunk) \u003e= 64: block = self.chunk[:64] self._compress(block) self.chunk = self.chunk[64:] def _compress(self, block: bytes): if len(block) \u003c 64: raise ValueError(\"compress error: not enough data\") W = [0] * 132 for i in range(16): W[i] = ( (block[4 * i] \u003c\u003c 24) | (block[4 * i + 1] \u003c\u003c 16) | (block[4 * i + 2] \u003c\u003c 8) | (block[4 * i + 3]) ) \u0026 0xffffffff for i in range(16, 68): tmp = W[i - 16] ^ W[i - 9] ^ rotl(W[i - 3], 15) tmp = tmp ^ rotl(tmp, 15) ^ rotl(tmp, 23) W[i] = (tmp ^ rotl(W[i - 13], 7) ^ W[i - 6]) \u0026 0xffffffff for i in range(64): W[i + 68] = (W[i] ^ W[i + 4]) \u0026 0xffffffff a, b, c, d, e, f, g, h = self.reg for j in range(64): ss1 = (rotl(a, 12) + e + rotl(Tj(j), j)) \u0026 0xffffffff ss1 = rotl(ss1 \u0026 0xffffffff, 7) ss2 = ss1 ^ rotl(a, 12) tt1 = (FF(j, a, b, c) + d + ss2 + W[j + 68]) \u0026 0xffffffff tt2 = (GG(j, e, f, g) + h + ss1 + W[j]) \u0026 0xffffffff d = c c = rotl(b, 9) b = a a = tt1 \u0026 0xffffffff h = g g = rotl(f, 19) f = e e = (tt2 ^ rotl(tt2, 9) ^ rotl(tt2, 17)) \u0026 0xffffffff self.reg = [ (self.reg[0] ^ a) \u0026 0xffffffff, (self.reg[1] ^ b) \u0026 0xffffffff, (self.reg[2] ^ c) \u0026 0xffffffff, (self.reg[3] ^ d) \u0026 0xffffffff, (self.reg[4] ^ e) \u0026 0xffffffff, (self.reg[5] ^ f) \u0026 0xffffffff, (self.reg[6] ^ g) \u0026 0xffffffff, (self.reg[7] ^ h) \u0026 0xffffffff, ] def _fill(self): t = self.size * 8 self.chunk.append(0x80) while (len(self.chunk) % 64) != 56: self.chunk.append(0) high = (t \u003e\u003e 32) \u0026 0xffffffff low = t \u0026 0xffffffff for e in range(4): self.chunk.append((high \u003e\u003e (8 * (3 - e))) \u0026 0xff) for e in range(4): self.chunk.append((low \u003e\u003e (8 * (3 - e))) \u0026 0xff) def sum(self, data=None, mode=None): if data is not None: self.reset() self.write(data) self._fill() for i in range(0, len(self.chunk), 64): self._compress(self.chunk[i:i + 64]) if mode == \"hex\": out = \"\".join(f\"{x:08x}\" for x in self.reg) else: out = [] for x in self.reg: out.extend([ (x \u003e\u003e 24) \u0026 0xff, (x \u003e\u003e 16) \u0026 0xff, (x \u003e\u003e 8) \u0026 0xff, x \u0026 0xff, ]) self.reset() return out sm3 = SM3() if as_hex: return sm3.sum(n_str, mode=\"hex\") else: return sm3.sum(n_str) 测试解密均可以\n后续再整理，以上是整个过程中自己的所有思路，很乱！仅供参考\n",
  "wordCount" : "4524",
  "inLanguage": "en",
  "image": "https://l0x1c.com/images/papermod-cover.png","datePublished": "2025-11-15T17:59:02+08:00",
  "dateModified": "2025-11-15T17:59:02+08:00",
  "author":{
    "@type": "Person",
    "name": "L0x1c"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://l0x1c.com/posts/dy_web_a_bogus/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "L0x1c's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://l0x1c.com/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://l0x1c.com/" accesskey="h" title="L0x1c&#39;s Blog (Alt + H)">L0x1c&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://l0x1c.com/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://l0x1c.com/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://l0x1c.com/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://l0x1c.com/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://l0x1c.com/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://l0x1c.com/">Home</a>&nbsp;»&nbsp;<a href="https://l0x1c.com/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      dy a_bogus参数 逆向分析
      <span class="entry-hint" title="Draft">
        <svg xmlns="http://www.w3.org/2000/svg" height="35" viewBox="0 -960 960 960" fill="currentColor">
          <path
            d="M160-410v-60h300v60H160Zm0-165v-60h470v60H160Zm0-165v-60h470v60H160Zm360 580v-123l221-220q9-9 20-13t22-4q12 0 23 4.5t20 13.5l37 37q9 9 13 20t4 22q0 11-4.5 22.5T862.09-380L643-160H520Zm300-263-37-37 37 37ZM580-220h38l121-122-18-19-19-18-122 121v38Zm141-141-19-18 37 37-18-19Z" />
        </svg>
      </span>
    </h1>
    <div class="post-meta"><span title='2025-11-15 17:59:02 +0800 +0800'>November 15, 2025</span>&nbsp;·&nbsp;22 min&nbsp;·&nbsp;L0x1c

</div>
  </header> 

  <div class="post-content"><p>关于<code>dy</code>的<code>a_bogus</code>逆向，<code>jsvmp</code></p>
<p>进行抖音抓包，对应的位置在</p>
<p><img loading="lazy" src="image-20251112152426947.png" alt="image-20251112152426947"  />
</p>
<pre tabindex="0"><code>url = &#34;https://www.douyin.com/aweme/v1/web/aweme/post/&#34;
</code></pre><p>可以看一下调用栈，不难发现主要的逻辑在<code>bdms_1.0.1.19_fix.js</code></p>
<p><img loading="lazy" src="image-20251112152556501.png" alt="image-20251112152556501"  />
</p>
<p>直接跳过去可以看到d就是指令操作</p>
<p><img loading="lazy" src="image-20251112153117133.png" alt="image-20251112153117133"  />
</p>
<p>先一点一点的去看</p>
<p><img loading="lazy" src="image-20251112160500559.png" alt="image-20251112160500559"  />
</p>
<p>这个位置调用了atob，代表了对下面的那个字符进行了base64的解密，随后取第 4~7 字节求和得到单字节 key</p>
<p><img loading="lazy" src="image-20251112160806447.png" alt="image-20251112160806447"  />
</p>
<p>再用自定义 map 函数 <code>_</code> 对余下字节逐个异或，最后把结果送进自带的 DEFLATE 解压器，从而得到可执行的数据块，这里可以很好的看出来这一块是一个压缩文件的格式，对应base64的UEsC</p>
<p><img loading="lazy" src="image-20251112161227168.png" alt="image-20251112161227168"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">base64</span><span class="o">,</span> <span class="nn">zlib</span><span class="o">,</span> <span class="nn">re</span><span class="o">,</span> <span class="nn">hashlib</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BASE64_DATA</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&#34;&#34;&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="c1"># ==============================================</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sanitize_b64</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^A-Za-z0-9+/=]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">xor_transform</span><span class="p">(</span><span class="n">decoded</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="n">key_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">decoded</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">8</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">km</span> <span class="o">=</span> <span class="n">key_sum</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">    <span class="n">step</span> <span class="o">=</span> <span class="n">km</span> <span class="o">%</span> <span class="mi">10</span>
</span></span><span class="line"><span class="cl">    <span class="n">tail</span> <span class="o">=</span> <span class="n">decoded</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tail</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tail</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="p">((</span><span class="n">km</span> <span class="o">+</span> <span class="n">step</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">),</span> <span class="n">key_sum</span><span class="p">,</span> <span class="n">km</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">inflate_raw</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">zlib</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">b64</span> <span class="o">=</span> <span class="n">sanitize_b64</span><span class="p">(</span><span class="n">BASE64_DATA</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">b64</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">mapped</span> <span class="o">=</span> <span class="n">xor_transform</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">payload</span> <span class="o">=</span> <span class="n">inflate_raw</span><span class="p">(</span><span class="n">mapped</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">out_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">/</span> <span class="s2">&#34;payload.bin&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">out_path</span><span class="o">.</span><span class="n">write_bytes</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></div><p>可以和dump的东西进行对应上</p>
<p><img loading="lazy" src="image-20251112162756570.png" alt="image-20251112162756570"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">W</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">e</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">;</span> <span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="nx">t</span><span class="p">.</span><span class="nx">d</span><span class="p">[</span><span class="nx">t</span><span class="p">.</span><span class="nx">i</span><span class="o">++</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">                    <span class="k">if</span> <span class="p">(</span><span class="nx">r</span> <span class="o">|=</span> <span class="p">(</span><span class="mi">127</span> <span class="o">&amp;</span> <span class="nx">n</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="nx">e</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="nx">e</span> <span class="o">+=</span> <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="o">!</span><span class="p">(</span><span class="mi">128</span> <span class="o">&amp;</span> <span class="nx">n</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">                        <span class="k">return</span> <span class="nx">e</span> <span class="o">&lt;</span> <span class="mi">32</span> <span class="o">&amp;&amp;</span> <span class="mi">64</span> <span class="o">&amp;</span> <span class="nx">n</span> <span class="o">?</span> <span class="nx">r</span> <span class="o">|</span> <span class="o">-</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="nx">e</span> <span class="o">:</span> <span class="nx">r</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>最开始的e9 07</p>
<p><code>0xe9</code> = <code>1110 1001</code></p>
<p>低 7 位 <code>0x69</code> = <code>105</code></p>
<p><code>0x07</code> = <code>0000 0111</code></p>
<p>低 7 位 <code>0x07</code> = <code>7</code></p>
<p>累加：<code>val += 7 &lt;&lt; 7 = 7 * 128 = 896</code></p>
<p>总和：<code>105 + 896 = 1001</code></p>
<p>所以字符串池的条数为<code>1001</code>条</p>
<p><img loading="lazy" src="image-20251112174006274.png" alt="image-20251112174006274"  />
</p>
<p>字符串的位置走过后，这个位置是函数表对应的条数</p>
<p><code>0x1C | 0x80 = 0x9C</code></p>
<p>计算后这个位置应该是796条，下图调试的位置吻合</p>
<p><img loading="lazy" src="image-20251112174451286.png" alt="image-20251112174451286"  />
</p>
<p>打印出来：</p>
<p><img loading="lazy" src="image-20251112175425724.png" alt="image-20251112175425724"  />
</p>
<p>字符串表</p>
<p><img loading="lazy" src="image-20251112175912681.png" alt="image-20251112175912681"  />
</p>
<p><code>a_bogus</code>对应的是表的<code>Z[220]</code></p>
<p>调试位置对应的<code>url</code>的方法</p>
<p><img loading="lazy" src="image-20251112165013930.png" alt="image-20251112165013930"  />
</p>
<p>调试到这里可以看到对应的字节码的东西为</p>
<p><img loading="lazy" src="image-20251112165335680.png" alt="image-20251112165335680"  />
</p>
<pre tabindex="0"><code>{&#34;f&#34;: [34, 54, 0, 3, 34, 30, 214, 41, 212, 34, 30, 214, 30, 70, 54, 0, 4, 74, 0, 4, 30, 218, 54, 0, 5, 74, 0, 5, 30, 72, 54, 0, 6, 33, 74, 2, 33, 74, 0, 6, 0, 1, 54, 0, 7, 74, 0, 7, 41, 5, 74, 0, 6, 53, 11, 60, 161, 74, 0, 6, 60, 216, 30, 178, 59, 2, 54, 0, 8, 74, 0, 8, 30, 162, 18, 30, 219, 73, 165, 0, 1, 29, 17, 5, 74, 2, 3, 30, 150, 41, 18, 74, 0, 8, 30, 162, 18, 30, 163, 73, 165, 74, 2, 3, 30, 150, 0, 2, 26, 74, 0, 8, 30, 162, 18, 30, 219, 73, 220, 0, 1, 29, 41, 45, 33, 74, 3, 14, 0, 0, 26, 33, 74, 2, 37, 74, 0, 8, 30, 162, 18, 30, 9, 0, 0, 74, 0, 2, 0, 2, 54, 0, 9, 74, 0, 8, 30, 162, 18, 30, 163, 73, 220, 74, 0, 9, 0, 2, 26, 74, 0, 7, 29, 41, 10, 74, 0, 5, 74, 0, 8, 30, 178, 20, 72, 34, 30, 214, 18, 30, 51, 63, 108, 0, 1, 26, 33, 74, 2, 36, 74, 0, 8, 30, 215, 0, 1, 41, 7, 33, 74, 2, 5, 0, 0, 26, 34, 73, 214, 25, 26, 74, 1, 4, 18, 30, 126, 34, 74, 0, 2, 39, 1, 0, 2, 26, 33, 76], &#34;i&#34;: 1, &#34;u&#34;: true, &#34;s&#34;: []},
</code></pre><p>这个序列是给<code>&quot;a_bogus&quot;</code>赋值的序列</p>
<p>观察这个<code>a_bogus</code>的赋值的情况，是在<code>var m = n.apply(d, e)</code>中给值放到了<code>v[p++]</code>中，观察<code>e</code>的值的来源，在观察整个虚拟机，可以看到所有的<code>v[p]</code>都参与了基本指令运算，关于<code>+-*/%&amp;&gt;&gt;&lt;&lt;</code>，而且观察所有的基本运算所虚拟机表示的中的位置只有一个，那么可以思考就是对于每一个<code>opcode</code>，这个虚拟机只对应了简单的指令运算，然后进行大量的拼接得到的算法，所以只需要对这些基本运算进行插庄打<code>log</code>就可以看到整个流程的生成了</p>
<p><img loading="lazy" src="image-20251113103317350.png" alt="image-20251113103317350"  />
</p>
<p>打log的位置：所有基本运算，以及最后的放到v[++p]位置的地方</p>
<pre tabindex="0"><code>&#39;m:&#39;,m,&#39;n:&#39;,n,&#39;d:&#39;,d,&#39;e:&#39;,e
&#39;v[p]:&#39;,v[p] &gt; w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;&gt;&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] % E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;%&#39;,&#39;E:&#39;,E
&#39;v[p]:&#39;,v[p] &amp; E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;&amp;&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] &gt;&gt;&gt; w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;&gt;&gt;&gt;&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] - E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;-&#39;,&#39;E:&#39;,E
&#39;v[p]:&#39;,v[p] &gt;&gt; w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;&gt;&gt;&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] / E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;/&#39;,&#39;E:&#39;,E
&#39;v[p]:&#39;,v[p] * E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;*&#39;,&#39;E:&#39;,E
&#39;v[p]:&#39;,v[p] | w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;|&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] &lt;&lt; w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;&lt;&lt;&#39;,&#39;w:&#39;,w
&#39;v[p]:&#39;,v[p] + E ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;+&#39;,&#39;E:&#39;,E
&#39;v[p]:&#39;,v[p] ^ w ,&#39;=&#39;,&#39;v[p]:&#39;,v[p],&#39;^&#39;,&#39;w:&#39;,w
</code></pre><p>直接开始跑，我们从最后生成往上回溯分析</p>
<p><img loading="lazy" src="image-20251113105409137.png" alt="image-20251113105409137"  />
</p>
<p>可以看到<code>a_bogus</code>，这里满足<code>base64</code>变表，直接写个脚本测试一下</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BASE_TABLE</span> <span class="o">=</span> <span class="s2">&#34;Dkdpgh2ZmsQB80/MfvV36XI1R45-WUAlEixNLwoqYTOPuzKFjJnry79HbGcaStCe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_decode</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="p">{</span><span class="n">ch</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">block</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s2">&#34;=&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;字母表中不存在字符: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">ch</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_encode</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded</span> <span class="o">=</span> <span class="s2">&#34;Q6UVhHtyDdWRKVFGuCcOeJKU2Uj/rPuynlTdbzPPtBtTOq0aBSP2MnbScouJskbjL8BziKVHqEtlbDnczGU0Z99kzmpDSm4fosVCV68oZqwgTeGmLrD/ehhzuwBC0QJwl5C6NAU51sBn2jVAIq5uWd3GH5To5bEdSrZ6D/LytEAgfCSkk93kOCDdEgaFUvcG&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="n">b64_swap_decode</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">BASE_TABLE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decoded bytes:&#34;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decoded as UTF-8:&#34;</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;replace&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decimal values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">))</span>
</span></span></code></pre></div><p><img loading="lazy" src="image-20251113105808231.png" alt="image-20251113105808231"  />
</p>
<p>可以看到和刚过来的数组是一样的</p>
<p><img loading="lazy" src="image-20251113105827094.png" alt="image-20251113105827094"  />
</p>
<p>在这里可以看到，这里的字符是拼接来的，前4字节和后面进行了拼接，先看一下后面的字节的来源</p>
<p><img loading="lazy" src="image-20251113105939089.png" alt="image-20251113105939089"  />
</p>
<p>追上去后可以看到两个部分的线索，直接直接就可以根据rc4的特征来看到，这部分上面是表的生成，下面是标准的rc4的算法（除了表生成位置）</p>
<p><img loading="lazy" src="image-20251113110100556.png" alt="image-20251113110100556"  />
</p>
<p>表生成位置：</p>
<p><img loading="lazy" src="image-20251113110217140.png" alt="image-20251113110217140"  />
</p>
<p>直接根据他给的写就行，写一下算法，<code>key</code>可以很好的看到是<code>211</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BASE_TABLE</span> <span class="o">=</span> <span class="s2">&#34;Dkdpgh2ZmsQB80/MfvV36XI1R45-WUAlEixNLwoqYTOPuzKFjJnry79HbGcaStCe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">seed</span> <span class="o">=</span> <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span> <span class="k">if</span> <span class="n">key</span> <span class="k">else</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">z</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span> <span class="o">+</span> <span class="n">seed</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">z</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xff</span>
</span></span><span class="line"><span class="cl">        <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">K</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[(</span><span class="n">raw</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">raw</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_decode</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="p">{</span><span class="n">ch</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">block</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s2">&#34;=&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;字母表中不存在字符: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">ch</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_encode</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">encoded</span> <span class="o">=</span> <span class="s2">&#34;Q6UVhHtyDdWRKVFGuCcOeJKU2Uj/rPuynlTdbzPPtBtTOq0aBSP2MnbScouJskbjL8BziKVHqEtlbDnczGU0Z99kzmpDSm4fosVCV68oZqwgTeGmLrD/ehhzuwBC0QJwl5C6NAU51sBn2jVAIq5uWd3GH5To5bEdSrZ6D/LytEAgfCSkk93kOCDdEgaFUvcG&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">raw</span> <span class="o">=</span> <span class="n">b64_swap_decode</span><span class="p">(</span><span class="n">encoded</span><span class="p">,</span> <span class="n">BASE_TABLE</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decoded bytes:&#34;</span><span class="p">,</span> <span class="n">raw</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decoded as UTF-8:&#34;</span><span class="p">,</span> <span class="n">raw</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;replace&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Decimal values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">rc4_decoded</span> <span class="o">=</span> <span class="n">rc4</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="nb">bytes</span><span class="p">([</span><span class="mi">211</span><span class="p">]))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;RC4 Decoded bytes:&#34;</span><span class="p">,</span> <span class="n">rc4_decoded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;RC4 Decoded as UTF-8:&#34;</span><span class="p">,</span> <span class="n">rc4_decoded</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s2">&#34;replace&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;RC4 Decimal values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">rc4_decoded</span><span class="p">))</span>
</span></span></code></pre></div><pre tabindex="0"><code>RC4 Decimal values: 3 84 32 64 33 16 162 84 145 78 212 47 217 0 218 161 17 64 33 0 221 1 3 144 201 90 33 149 230 218 40 130 200 239 38 227 60 31 8 2 65 66 51 156 107 4 20 27 128 0 206 12 194 64 44 16 155 97 185 240 16 67 40 0 144 43 208 32 107 108 40 17 148 2 29 32 165 113 26 49 253 55 27 54 178 126 17 112 52 113 22 49 236 120 57 56 34 62 49 113 36 49 54 49 124 122 25 56 35 62 53 113 53 113 30 49 108 121 48 56 179 124 105 92 224 35 105 75 255 54 73 100 125 50 52 38 164 110 183 29
</code></pre><p><img loading="lazy" src="image-20251113110433448.png" alt="image-20251113110433448"  />
</p>
<p><code>rc4</code>这个位置是没有错的，继续往下分析</p>
<p>前面四个字节的来源，前四个字节是<code>41 71 82 23</code>看一下来源</p>
<p><img loading="lazy" src="image-20251113110915960.png" alt="image-20251113110915960"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_s</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># a = (int(random.random() * 65535)) &amp; 0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># b = int(random.random() * 40)</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.5446416885859573</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.5832301287563609</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x01</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x02</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x50</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x02</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">  
</span></span><span class="line"><span class="cl"><span class="c1">#Generated 4 bytes: b&#39;)GR\x17&#39;</span>
</span></span><span class="line"><span class="cl"><span class="c1">#Generated Decimal values: 41 71 82 23</span>
</span></span></code></pre></div><p>再往上追可以看到，这个刚才rc4解密的数组是通过8为数组+132位数组来的</p>
<p><img loading="lazy" src="image-20251113111746995.png" alt="image-20251113111746995"  />
</p>
<p>第一组的地方<code>3, 84, 32, 64</code></p>
<p><img loading="lazy" src="image-20251113112712347.png" alt="image-20251113112712347"  />
</p>
<p>第二组的地方<code>33, 16, 162, 84</code></p>
<p><img loading="lazy" src="image-20251113113012341.png" alt="image-20251113113012341"  />
</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_r_head2</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># a= (int(random.random() * 240)) &amp; 0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># b = (int(random.random() * 255)) &amp; 0xFF &amp; 77</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.20071909122733345</span> <span class="o">*</span> <span class="mi">240</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.83287578221808</span> <span class="o">*</span> <span class="mi">255</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span> <span class="o">&amp;</span> <span class="mi">77</span>
</span></span><span class="line"><span class="cl">    <span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">b</span> <span class="o">|</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span></code></pre></div><p><img loading="lazy" src="image-20251113115048560.png" alt="image-20251113115048560"  />
</p>
<p>对应8字节后面的四位<code>33, 16, 162, 84</code></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">gen_r_head1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># z = int(random.random() * 65535)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># a = z &amp; 0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># b = (z &gt;&gt; 8) &amp; 0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.37632919615333793</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.37632919615333793</span> <span class="o">*</span> <span class="mi">65535</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x1</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0xAA</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">b</span> <span class="o">&amp;</span> <span class="mh">0x55</span><span class="p">)</span> <span class="o">|</span> <span class="mh">0x0</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">Length</span> <span class="n">of</span> <span class="n">gen</span><span class="p">:</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl"><span class="n">Generated</span> <span class="n">r_head</span> <span class="n">Decimal</span> <span class="n">values</span><span class="p">:</span> <span class="mi">3</span> <span class="mi">84</span> <span class="mi">32</span> <span class="mi">64</span> <span class="mi">33</span> <span class="mi">16</span> <span class="mi">162</span> <span class="mi">84</span>
</span></span></code></pre></div><p>正好对应上了</p>
<p><img loading="lazy" src="image-20251113124243229.png" alt="image-20251113124243229"  />
</p>
<p>网上回溯看一下这个是怎么生成的，这个时候可以看到这里面永远都会一组重复的数字<code>145, 110, 66, 189, 44, 211</code></p>
<p><img loading="lazy" src="image-20251113130011811.png" alt="image-20251113130011811"  />
</p>
<p>根据上面可以写出加密逻辑</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">145</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">211</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">159</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">rad</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.21538688661648553</span><span class="p">,</span><span class="mf">0.9212125883092179</span><span class="p">,</span><span class="mf">0.11329993696990215</span><span class="p">,</span><span class="mf">0.4012867884874777</span><span class="p">,</span><span class="mf">0.7397694321593413</span><span class="p">,</span><span class="mf">0.2345646507296566</span><span class="p">,</span><span class="mf">0.48677241706302965</span><span class="p">,</span><span class="mf">0.02660945354489941</span><span class="p">,</span><span class="mf">0.3556811964939194</span><span class="p">,</span><span class="mf">0.7736328373701941</span><span class="p">,</span><span class="mf">0.6529429229670689</span><span class="p">,</span><span class="mf">0.4924646761384377</span><span class="p">,</span><span class="mf">0.7613914142703988</span><span class="p">,</span><span class="mf">0.3780540061140839</span><span class="p">,</span><span class="mf">0.9141587354910575</span><span class="p">,</span><span class="mf">0.10551554793573337</span><span class="p">,</span><span class="mf">0.15838251707991813</span><span class="p">,</span><span class="mf">0.7137565040911108</span><span class="p">,</span><span class="mf">0.4114927013372691</span><span class="p">,</span><span class="mf">0.21053933074769915</span><span class="p">,</span><span class="mf">0.5965956170259822</span><span class="p">,</span><span class="mf">0.23215038617850303</span><span class="p">,</span><span class="mf">0.2901816263862327</span><span class="p">,</span><span class="mf">0.29295876428660983</span><span class="p">,</span><span class="mf">0.6021625523305605</span><span class="p">,</span><span class="mf">0.039574963495331406</span><span class="p">,</span><span class="mf">0.6054109386072396</span><span class="p">,</span><span class="mf">0.09645229970364944</span><span class="p">,</span><span class="mf">0.5053147091841774</span><span class="p">,</span><span class="mf">0.938315440828625</span><span class="p">,</span><span class="mf">0.41117788486726015</span><span class="p">,</span><span class="mf">0.05572314150793589</span><span class="p">,</span><span class="mf">0.9985371346724156</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1">#v = (int(random.random() * 1000)) &amp; 0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rad</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">v</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">v</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">])))</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">v</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">])))</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">chr</span><span class="p">((</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])))</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">data_result</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">result</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;latin-1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">data_result</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span> <span class="k">for</span> <span class="n">byte</span> <span class="ow">in</span> <span class="n">data_result</span><span class="p">))</span>
</span></span></code></pre></div><p>同理解密逻辑为</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span> <span class="o">=</span> <span class="p">[</span><span class="mi">145</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">211</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">r0</span><span class="p">,</span> <span class="n">r1</span><span class="p">,</span> <span class="n">r2</span><span class="p">,</span> <span class="n">r3</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">r0</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">r3</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">r1</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">r3</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">c</span> <span class="o">=</span> <span class="p">(</span><span class="n">r2</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">r3</span> <span class="o">&amp;</span> <span class="n">key</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span></code></pre></div><p><img loading="lazy" src="image-20251113135029934.png" alt="image-20251113135029934"  />
</p>
<p>对应了：</p>
<pre tabindex="0"><code>[1,14,252,201,0,242,0,0,1,220,1,3,217,24,5,230,154,0,201,239,34,44,31,0,208,0,31,123,6,24,0,0,206,82,0,0,154,97,177,0,1,0,0,41,240,123,44,0,4,0,49,53,49,50,124,55,55,50,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,57,56,50,124,77,97,99,73,110,116,101,108,50,52,53,44,159
]
</code></pre><p>继续往上根</p>
<p><img loading="lazy" src="image-20251113135403102.png" alt="image-20251113135403102"  />
</p>
<p>他把刚才的这些数据进行了分组</p>
<pre tabindex="0"><code>[1,14,252,201,0,242,0,0,1,220,1,3,217,24,5,230,154,0,201,239,34,44,31,0,208,0,31,123,6,24,0,0,206,82,0,0,154,97,177,0,1,0,0,41,240,123,44,0,4,0]
[49,53,49,50,124,55,55,50,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,56,57,51,124,49,53,49,50,124,57,56,50,124,77,97,99,73,110,116,101,108]
[50,52,53,44]
[159]
</code></pre><p>中间的第二组，从刚才的解密结果可以发现，这个数组是一些可能带有的参数</p>
<pre tabindex="0"><code>1512|772|1512|893|1512|893|1512|982|MacIntel%
</code></pre><p>那么剩下关心的就是剩下的这几组的参数了</p>
<p>四位的情况向上回溯，和时间戳有关系</p>
<p><img loading="lazy" src="image-20251113140027821.png" alt="image-20251113140027821"  />
</p>
<p>可以看到最后的那个单个的数字<code>159</code>是经过很多次的<code>xor</code>得到的</p>
<p><img loading="lazy" src="image-20251113141944377.png" alt="image-20251113141944377"  />
</p>
<p>如果你的记忆里很好的话，看到这里的时候你就一定会知道这些东西你见过，就是之前那个随机的8位数</p>
<p><img loading="lazy" src="image-20251113142714362.png" alt="image-20251113142714362"  />
</p>
<p><code>Generated r_head Decimal values: 3 84 32 64 33 16 162 84</code></p>
<p>这个时候就会疑问这个41后面的都是哪里来的，重新<code>trace</code>看一下对应的位置</p>
<p><img loading="lazy" src="image-20251113162251756.png" alt="image-20251113162251756"  />
</p>
<p><code>Xor 41</code>索引位置<code>24</code></p>
<p><img loading="lazy" src="image-20251113162549630.png" alt="image-20251113162549630"  />
</p>
<p>依次把x都拿出来，就可以得到索引</p>
<pre tabindex="0"><code>[24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51, 52, 53, 55, 56, 57, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 79, 80, 84, 85]
</code></pre><p>写代码实现就是</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">w_8</span> <span class="o">=</span> <span class="p">[</span><span class="mi">169</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">21</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">table_gobal</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;5&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;aid&#34;</span><span class="p">:</span> <span class="mi">6383</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;pageId&#34;</span><span class="p">:</span> <span class="mi">6241</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;boe&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ddrt&#34;</span><span class="p">:</span> <span class="mf">8.5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;paths&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;include&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">],</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;exclude&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                        <span class="p">{}</span>
</span></span><span class="line"><span class="cl">                    <span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;track&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;mode&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;delay&#34;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="s2">&#34;paths&#34;</span><span class="p">:</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">                <span class="p">},</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;slU&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;dump&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;rpU&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;ic&#34;</span><span class="p">:</span> <span class="mf">8.5</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;dhzx&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1763021788706</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s2">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;Chrome&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;0&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;1&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;2&#34;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;3&#34;</span><span class="p">:</span> <span class="s2">&#34;device_platform=webapp&amp;aid=6383&amp;channel=channel_pc_web&amp;sec_user_id=MS4wLjABAAAAofq0Vvn8ISgdgZ-eX4lgGoJb1BQDtjB3K7I8XzjTfW3hMgZ9gaaJnYy-Er1k5QRi&amp;max_cursor=0&amp;locate_query=false&amp;show_live_replay_strategy=1&amp;need_time_list=1&amp;time_list_query=0&amp;whale_cut_token=&amp;cut_version=1&amp;count=18&amp;publish_video_strategy_type=2&amp;from_user_page=1&amp;update_version_code=170400&amp;pc_client_type=1&amp;pc_libra_divert=Mac&amp;support_h265=1&amp;support_dash=1&amp;cpu_core_num=10&amp;version_code=290100&amp;version_name=29.1.0&amp;cookie_enabled=true&amp;screen_width=1512&amp;screen_height=982&amp;browser_language=zh-CN&amp;browser_platform=MacIntel&amp;browser_name=Chrome&amp;browser_version=142.0.0.0&amp;browser_online=true&amp;engine_name=Blink&amp;engine_version=142.0.0.0&amp;os_name=Mac+OS&amp;os_version=10.15.7&amp;device_memory=8&amp;platform=PC&amp;downlink=10&amp;effective_type=4g&amp;round_trip_time=50&amp;webid=7537255736499029513&amp;uifid=ecb38e5e86f1f8799c3256ca6c3446710d152cd7b76a2f92ca888d379e861b9ef6c3c057199fbabeb251493a65cd070d26b3aeca82ccc95af03dc3a8930e7db657234d4ca4acb8174f8b9e3cab43ff6260ae432fd24dfe6de26ecc544bf0426c0fb819444e48099c31f99143dab6d5c48975b8b37a257b159ef2fe6dacc5252904813ff4b25bebd8458d1565ef36ce45b9144f443029919505f73dca564bcd4a&amp;msToken=_ldHApyvIwdTTeKAtEdJ420xs1ltIcgsNMzR0bX8PJ5sv86p7ORbTipL0ylgxU3ZmrrxoR-Rv6qwyig0-yZPE26FFFIFwRgTGONu1NN5FlswqC5B2WRWvp3ESGTQNFgQOgIor-bnh8BYHfUnAyQGwl_VuKgrY2s_WeRVHHN4nLRd1nxcNjjF-A%3D%3D&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;4&#34;</span><span class="p">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;5&#34;</span><span class="p">:</span> <span class="s2">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;6&#34;</span><span class="p">:</span> <span class="mi">6241</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;7&#34;</span><span class="p">:</span> <span class="mi">6383</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;8&#34;</span><span class="p">:</span> <span class="s2">&#34;1.0.1.19-fix.01&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">8</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;device_platform=webapp&amp;aid=6383&amp;channel=channel_pc_web&amp;sec_user_id=MS4wLjABAAAAofq0Vvn8ISgdgZ-eX4lgGoJb1BQDtjB3K7I8XzjTfW3hMgZ9gaaJnYy-Er1k5QRi&amp;max_cursor=0&amp;locate_query=false&amp;show_live_replay_strategy=1&amp;need_time_list=1&amp;time_list_query=0&amp;whale_cut_token=&amp;cut_version=1&amp;count=18&amp;publish_video_strategy_type=2&amp;from_user_page=1&amp;update_version_code=170400&amp;pc_client_type=1&amp;pc_libra_divert=Mac&amp;support_h265=1&amp;support_dash=1&amp;cpu_core_num=10&amp;version_code=290100&amp;version_name=29.1.0&amp;cookie_enabled=true&amp;screen_width=1512&amp;screen_height=982&amp;browser_language=zh-CN&amp;browser_platform=MacIntel&amp;browser_name=Chrome&amp;browser_version=142.0.0.0&amp;browser_online=true&amp;engine_name=Blink&amp;engine_version=142.0.0.0&amp;os_name=Mac+OS&amp;os_version=10.15.7&amp;device_memory=8&amp;platform=PC&amp;downlink=10&amp;effective_type=4g&amp;round_trip_time=50&amp;webid=7537255736499029513&amp;uifid=ecb38e5e86f1f8799c3256ca6c3446710d152cd7b76a2f92ca888d379e861b9ef6c3c057199fbabeb251493a65cd070d26b3aeca82ccc95af03dc3a8930e7db657234d4ca4acb8174f8b9e3cab43ff6260ae432fd24dfe6de26ecc544bf0426c0fb819444e48099c31f99143dab6d5c48975b8b37a257b159ef2fe6dacc5252904813ff4b25bebd8458d1565ef36ce45b9144f443029919505f73dca564bcd4a&amp;msToken=_ldHApyvIwdTTeKAtEdJ420xs1ltIcgsNMzR0bX8PJ5sv86p7ORbTipL0ylgxU3ZmrrxoR-Rv6qwyig0-yZPE26FFFIFwRgTGONu1NN5FlswqC5B2WRWvp3ESGTQNFgQOgIor-bnh8BYHfUnAyQGwl_VuKgrY2s_WeRVHHN4nLRd1nxcNjjF-A%3D%3D&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">6241</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">6383</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;1.0.1.19-fix.01&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;ink&#34;</span><span class="p">:</span> <span class="mi">1763021788706</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;value&#34;</span><span class="p">:</span> <span class="s2">&#34;0X21&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;writable&#34;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;enumerable&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;configurable&#34;</span><span class="p">:</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1763021788708</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;reg&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="mi">1937774191</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">1226093241</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">388252375</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">3666478592</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">2842636476</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">372324522</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">3817729613</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="mi">2969243214</span>
</span></span><span class="line"><span class="cl">        <span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;chunk&#34;</span><span class="p">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;size&#34;</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">88</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">25</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">204</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">46</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">136</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">235</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">122</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">23</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">207</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">160</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">48</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">143</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">135</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">25</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">194</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">108</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">224</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">238</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">26</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">252</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">36</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">188</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">147</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">131</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">64</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">253</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">156</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">96</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">159</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">27</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">122</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">82</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">52</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">197</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">120</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">234</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">119</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">245</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">89</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">71</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">177</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">98</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">28</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">142</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">123</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">199</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">176</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">152</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">240</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;eWgvhqF7obsvc6EpmziycV7XL8a0cgI1T8jgTKeNbjPeaKF1gvtiAPTEZavZAo08AIP6CdZALC6EbNqevfpUebcct0j7VPPDkRfsBmBXxwdsjBBMnjZ8biljt0Eg1OEzGvPt3LjptJUTYvu+JLsMBZ6mXcXV&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">135</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">211</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">192</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">208</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">120</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">79</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">137</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">215</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">252</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">68</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">137</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">10</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">133</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">247</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">147</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">234</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">206</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">193</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">81</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">115</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">135</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">232</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">128</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">141</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">199</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1763021788706</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">82</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">41</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">36</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">154</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">23</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">204</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">82</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">177</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">4</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">252</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">206</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">208</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">154</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">239</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;innerWidth&#34;</span><span class="p">:</span> <span class="mi">1512</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;innerHeight&#34;</span><span class="p">:</span> <span class="mi">772</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;outerWidth&#34;</span><span class="p">:</span> <span class="mi">1512</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;outerHeight&#34;</span><span class="p">:</span> <span class="mi">893</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;availWidth&#34;</span><span class="p">:</span> <span class="mi">1512</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;availHeight&#34;</span><span class="p">:</span> <span class="mi">893</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;sizeWidth&#34;</span><span class="p">:</span> <span class="mi">1512</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;sizeHeight&#34;</span><span class="p">:</span> <span class="mi">982</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;platform&#34;</span><span class="p">:</span> <span class="s2">&#34;MacIntel&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;1512|772|1512|893|1512|893|1512|982|MacIntel&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">110</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">116</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">101</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">108</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;39,&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">169</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">21</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">136</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">81</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">137</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">81</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">162</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">21</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="mi">104</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">14</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">252</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">36</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">204</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">5</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">23</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">154</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">239</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">208</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">6</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">24</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">206</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">82</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">154</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">177</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">41</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">34</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">77</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">73</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">110</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">116</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">101</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">108</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">57</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">104</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;</span><span class="se">\u000b\u0003</span><span class="s2">r</span><span class="se">\u0007</span><span class="s2">&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mi">128</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">12</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">216</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">47</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">180</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">9</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">7</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">220</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">90</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">132</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">150</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">216</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">19</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">134</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">173</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">242</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">11</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">64</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">208</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">152</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">236</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">70</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">28</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">26</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">128</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">194</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">12</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">67</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">36</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">155</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">145</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">240</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">3</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">40</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">0</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">129</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">107</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">38</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">32</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">108</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">32</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">16</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">2</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">66</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">21</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">33</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">164</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">62</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">237</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">55</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">63</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">126</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">112</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">165</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">115</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">252</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">120</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">113</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">53</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">51</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">26</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">124</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">122</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">29</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">178</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">60</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">21</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">113</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">37</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">115</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">50</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">49</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">236</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">121</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">20</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">56</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">35</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">62</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">65</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">92</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">113</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">99</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">69</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">75</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">239</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">54</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">97</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">100</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">253</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">115</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">25</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">44</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mi">104</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;Õ5¨6°ø+¸¢¬¦ÿTëÉ</span><span class="se">\u001f</span><span class="s2">4#øFbÏëÔ®</span><span class="se">\u0019</span><span class="s2">¨sêaÊ.&gt;(Ê) fL4</span><span class="se">\u0017</span><span class="s2">åä·</span><span class="se">\u000f</span><span class="s2">Þ </span><span class="se">\u0004</span><span class="s2">º·×e</span><span class="se">\u001f</span><span class="s2">|Á´Ñ°pPÔ¶HÕf</span><span class="se">\u0016</span><span class="s2">xEåÚH0*üÑm¾Ro6em¯ö</span><span class="se">\u0018</span><span class="s2">pã</span><span class="se">\u0019</span><span class="s2">(Zv¨pµûýªvi¤</span><span class="se">\u0002</span><span class="s2">s1ð</span><span class="se">\u0000</span><span class="s2">yvÞ</span><span class="se">\u0007\u0015\u0003</span><span class="s2">Ã</span><span class="se">\u0001\u0017</span><span class="s2">dé«`C­Bgs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;</span><span class="se">\u000b\u0003</span><span class="s2">r</span><span class="se">\u0007</span><span class="s2">Õ5¨6°ø+¸¢¬¦ÿTëÉ</span><span class="se">\u001f</span><span class="s2">4#øFbÏëÔ®</span><span class="se">\u0019</span><span class="s2">¨sêaÊ.&gt;(Ê) fL4</span><span class="se">\u0017</span><span class="s2">åä·</span><span class="se">\u000f</span><span class="s2">Þ </span><span class="se">\u0004</span><span class="s2">º·×e</span><span class="se">\u001f</span><span class="s2">|Á´Ñ°pPÔ¶HÕf</span><span class="se">\u0016</span><span class="s2">xEåÚH0*üÑm¾Ro6em¯ö</span><span class="se">\u0018</span><span class="s2">pã</span><span class="se">\u0019</span><span class="s2">(Zv¨pµûýªvi¤</span><span class="se">\u0002</span><span class="s2">s1ð</span><span class="se">\u0000</span><span class="s2">yvÞ</span><span class="se">\u0007\u0015\u0003</span><span class="s2">Ã</span><span class="se">\u0001\u0017</span><span class="s2">dé«`C­Bgs&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;dj0nkt67Op5jCdKbYOnoe7VlcSLlNT8ymei2RueP7Qb4OZMORRNQBNbYnxoE4LjyhbpwiCVHLEeAYDVcztUwZHrkzmpvuZkfqtV9V0XohqihGUTmErDOe0hzFwsF0Yiw-5CWNlRRWsBN2VxAIq5YWB1ae5T955fdWrZjDZw9HEWXDS8kh93TO9kpP6sqWj==&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl"><span class="n">key</span> <span class="o">=</span> <span class="n">w_8</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">key</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table_gobal</span><span class="p">[</span><span class="n">w</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span> <span class="o">^</span> <span class="n">key</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="s2">&#34;s:&#34;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span></span></code></pre></div><p><img loading="lazy" src="image-20251113164322948.png" alt="image-20251113164322948"  />
</p>
<p>可以对应上</p>
<p><img loading="lazy" src="image-20251113164505338.png" alt="image-20251113164505338"  />
</p>
<p>同理上面如果继续看的还会看到一个表</p>
<pre tabindex="0"><code>[34, 44, 56, 61, 73, 29, 70, 45, 35, 49, 38, 66, 51, 68, 28, 48, 64, 47, 30, 71, 26, 55, 31, 69, 59, 40, 62, 63, 27, 72, 41, 74, 57, 52, 42, 39, 33, 67, 53, 43, 65, 46, 36, 24, 60, 32, 79, 80, 84, 85]
</code></pre><p>这个就是50位生成的地方，可以看到可以很完美的对应上</p>
<p><img loading="lazy" src="image-20251113165524893.png" alt="image-20251113165524893"  />
</p>
<p>继续向上看的话，可以看一个新的值</p>
<p><img loading="lazy" src="image-20251113165800930.png" alt="image-20251113165800930"  />
</p>
<p>这个位置对应了刚才分析到拿出来参数的这个位置</p>
<p><img loading="lazy" src="image-20251113165900174.png" alt="image-20251113165900174"  />
</p>
<p>可以很好的看出来这是一个sm3加密算法</p>
<p><img loading="lazy" src="image-20251113171114854.png" alt="image-20251113171114854"  />
</p>
<p>这个位置和js的某一个地方的源码一样，key = sum</p>
<p><img loading="lazy" src="image-20251113172357696.png" alt="image-20251113172357696"  />
</p>
<p>那么参数应该就是那个加密后的<code>base64</code>字符串</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sm3_hex</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">P0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">P1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">V</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x7380166F</span><span class="p">,</span> <span class="mh">0x4914B2B9</span><span class="p">,</span> <span class="mh">0x172442D7</span><span class="p">,</span> <span class="mh">0xDA8A0600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xA96F30BC</span><span class="p">,</span> <span class="mh">0x163138AA</span><span class="p">,</span> <span class="mh">0xE38DEE4D</span><span class="p">,</span> <span class="mh">0xB0FB0E4E</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitlen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">+=</span> <span class="n">bitlen</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;big&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">off</span><span class="p">:</span><span class="n">off</span><span class="o">+</span><span class="mi">64</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&#34;big&#34;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">52</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">68</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">P1</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="mi">15</span><span class="p">))</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">13</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">W1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">,</span><span class="n">Bb</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span> <span class="o">=</span> <span class="n">V</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">T</span> <span class="o">=</span> <span class="mh">0x79CC4519</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="mh">0x7A879D8A</span>
</span></span><span class="line"><span class="cl">            <span class="n">SS1</span> <span class="o">=</span> <span class="n">rol</span><span class="p">((</span><span class="n">rol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span> <span class="o">+</span> <span class="n">rol</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="mi">31</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">SS2</span> <span class="o">=</span> <span class="n">SS1</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">FF</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">^</span> <span class="n">Bb</span> <span class="o">^</span> <span class="n">C</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="p">((</span><span class="n">A</span> <span class="o">&amp;</span> <span class="n">Bb</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span> <span class="o">&amp;</span> <span class="n">C</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">Bb</span> <span class="o">&amp;</span> <span class="n">C</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">GG</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span> <span class="o">^</span> <span class="n">F</span> <span class="o">^</span> <span class="n">G</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="p">((</span><span class="n">E</span> <span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="o">~</span><span class="n">E</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">G</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">TT1</span> <span class="o">=</span> <span class="p">(</span><span class="n">FF</span> <span class="o">+</span> <span class="n">D</span> <span class="o">+</span> <span class="n">SS2</span> <span class="o">+</span> <span class="n">W1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">            <span class="n">TT2</span> <span class="o">=</span> <span class="p">(</span><span class="n">GG</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">SS1</span> <span class="o">+</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">            <span class="n">D</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Bb</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">C</span><span class="p">,</span> <span class="n">rol</span><span class="p">(</span><span class="n">Bb</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">TT1</span>
</span></span><span class="line"><span class="cl">            <span class="n">H</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">rol</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="n">E</span><span class="p">,</span> <span class="n">P0</span><span class="p">(</span><span class="n">TT2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">V</span> <span class="o">=</span> <span class="p">[(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="n">A</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">Bb</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="n">C</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="n">D</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="n">E</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">^</span><span class="n">F</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">^</span><span class="n">G</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">^</span><span class="n">H</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">08x</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">V</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="s2">&#34;eWgvhqF7obsvc6EpmziycV7XL8a0cgI1T8jgTKeNbjPeaKF1gvtiAPTEZavZAo08AIP6CdZALC6EbNqevfpUebcct0j7VPPDkRfsBmBXxwdsjBBMnjZ8biljt0Eg1OEzGvPt3LjptJUTYvu+JLsMBZ6mXcXV&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">dec_s</span> <span class="o">=</span> <span class="n">sm3_hex</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;SM3 Hash:&#34;</span><span class="p">,</span> <span class="n">dec_s</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dec_s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dec_s</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
</span></span></code></pre></div><pre tabindex="0"><code>34 2 135 211 192 208 65 120 79 137 215 252 68 7 137 60 10 133 247 147 234 206 193 40 81 115 135 232 128 141 33 199
</code></pre><p>和加密位置吻合</p>
<p><img loading="lazy" src="image-20251113182718468.png" alt="image-20251113182718468"  />
</p>
<p>这上面生成的还是之前那个base64变表，只是table换成了：ckdp1h4ZKsUB80/Mfvw36XIgR25+WQAlEi7NLboqYTOPuzmFjJnryx9HVGDaStCe</p>
<p>再往上看就是rc4的变种</p>
<p><img loading="lazy" src="image-20251113203632399.png" alt="image-20251113203632399"  />
</p>
<p>不过很奇怪，这个console的问题复制的变化后的表，不过可以通过输入和输出反推s盒</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_reverse_initial_s</span><span class="p">(</span><span class="n">plaintext</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">s_final</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ciphertext</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">K</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span> <span class="o">^</span> <span class="n">c</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">plaintext</span><span class="p">,</span> <span class="n">ciphertext</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">S</span> <span class="o">=</span> <span class="n">s_final</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="n">r</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">kbyte</span> <span class="o">=</span> <span class="n">K</span><span class="p">[</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">kbyte</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">q</span> <span class="o">-</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">S</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">p</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">c</span> <span class="o">=</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mi">21</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mi">255</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">186</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mi">175</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">     <span class="mi">176</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s_final</span> <span class="o">=</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">147</span><span class="p">,</span><span class="mi">251</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">74</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">246</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">172</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">148</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">245</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">183</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">146</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">254</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">237</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">247</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">249</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span><span class="mi">186</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">117</span><span class="p">,</span><span class="mi">227</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">173</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">167</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">156</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">211</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">232</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">184</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">212</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s_initial</span> <span class="o">=</span> <span class="n">rc4_reverse_initial_s</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s_final</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">s_initial</span><span class="p">)</span>
</span></span></code></pre></div><pre tabindex="0"><code>[110, 89, 245, 118, 200, 160, 49, 72, 67, 201, 108, 116, 250, 208, 8, 68, 126, 125, 165, 214, 55, 40, 217, 42, 66, 221, 189, 22, 123, 88, 122, 249, 159, 204, 198, 94, 163, 74, 105, 242, 87, 172, 252, 243, 174, 146, 206, 225, 43, 65, 229, 169, 168, 148, 248, 196, 247, 153, 150, 226, 48, 84, 240, 162, 139, 59, 157, 164, 31, 129, 52, 80, 103, 161, 81, 237, 75, 0, 177, 234, 219, 186, 223, 70, 155, 197, 37, 180, 246, 11, 56, 46, 62, 199, 86, 10, 179, 251, 181, 85, 193, 83, 97, 166, 141, 4, 230, 154, 51, 7, 36, 30, 233, 38, 57, 23, 254, 63, 239, 207, 192, 109, 45, 44, 195, 64, 17, 176, 115, 213, 132, 178, 253, 50, 238, 188, 21, 100, 93, 152, 79, 27, 28, 106, 99, 215, 13, 228, 183, 1, 210, 34, 131, 182, 107, 138, 175, 191, 145, 26, 90, 194, 18, 143, 3, 147, 202, 128, 135, 127, 158, 218, 98, 190, 117, 227, 15, 20, 12, 173, 235, 205, 69, 77, 120, 209, 61, 140, 231, 171, 241, 60, 41, 111, 114, 119, 14, 104, 71, 82, 76, 78, 6, 224, 167, 112, 25, 95, 156, 19, 39, 151, 16, 102, 47, 136, 134, 24, 203, 73, 92, 58, 121, 113, 187, 32, 211, 29, 101, 96, 54, 130, 137, 91, 220, 35, 144, 2, 149, 142, 232, 216, 5, 244, 124, 184, 9, 33, 170, 255, 222, 236, 53, 133, 185, 212]
</code></pre><p><img loading="lazy" src="image-20251113204457190.png" alt="image-20251113204457190"  />
</p>
<p>加密逻辑：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">random</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">BASE_TABLE</span> <span class="o">=</span> <span class="s2">&#34;ckdp1h4ZKsUB80/Mfvw36XIgR25+WQAlEi7NLboqYTOPuzmFjJnryx9HVGDaStCe&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_decode</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="p">{</span><span class="n">ch</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">alphabet</span><span class="p">)}</span>
</span></span><span class="line"><span class="cl">    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&#34;=&#34;</span> <span class="o">*</span> <span class="p">((</span><span class="mi">4</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">block</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="n">block</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">ch</span> <span class="ow">in</span> <span class="n">block</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">ch</span> <span class="o">==</span> <span class="s2">&#34;=&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">ch</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;字母表中不存在字符: </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">[</span><span class="n">ch</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">v</span> <span class="o">=</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">vals</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="n">vals</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span> <span class="o">&amp;</span> <span class="mh">0xFF</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">b64_swap_encode</span><span class="p">(</span><span class="n">b</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">alphabet</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">BASE_TABLE</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">chunk</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">pad</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">pad</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">chunk</span> <span class="o">=</span> <span class="n">chunk</span> <span class="o">+</span> <span class="sa">b</span><span class="s2">&#34;</span><span class="se">\x00</span><span class="s2">&#34;</span> <span class="o">*</span> <span class="n">pad</span>
</span></span><span class="line"><span class="cl">        <span class="n">val</span> <span class="o">=</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">chunk</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">|</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">==</span> <span class="mi">2</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[(</span><span class="n">val</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&#34;=&#34;</span> <span class="k">if</span> <span class="n">pad</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">alphabet</span><span class="p">[</span><span class="n">val</span> <span class="o">&amp;</span> <span class="mh">0x3F</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">sm3_hex</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span> <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">P0</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">P1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">V</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0x7380166F</span><span class="p">,</span> <span class="mh">0x4914B2B9</span><span class="p">,</span> <span class="mh">0x172442D7</span><span class="p">,</span> <span class="mh">0xDA8A0600</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="mh">0xA96F30BC</span><span class="p">,</span> <span class="mh">0x163138AA</span><span class="p">,</span> <span class="mh">0xE38DEE4D</span><span class="p">,</span> <span class="mh">0xB0FB0E4E</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="n">bitlen</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">((</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">64</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x00</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">m</span> <span class="o">+=</span> <span class="n">bitlen</span><span class="o">.</span><span class="n">to_bytes</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="s2">&#34;big&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">off</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">B</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">off</span><span class="p">:</span><span class="n">off</span><span class="o">+</span><span class="mi">64</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="o">.</span><span class="n">from_bytes</span><span class="p">(</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="s2">&#34;big&#34;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">52</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">68</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">P1</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">16</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span> <span class="mi">15</span><span class="p">))</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">13</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">6</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">        <span class="n">W1</span> <span class="o">=</span> <span class="p">[(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">A</span><span class="p">,</span><span class="n">Bb</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">D</span><span class="p">,</span><span class="n">E</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">,</span><span class="n">H</span> <span class="o">=</span> <span class="n">V</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">T</span> <span class="o">=</span> <span class="mh">0x79CC4519</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="mh">0x7A879D8A</span>
</span></span><span class="line"><span class="cl">            <span class="n">SS1</span> <span class="o">=</span> <span class="n">rol</span><span class="p">((</span><span class="n">rol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span> <span class="o">+</span> <span class="n">rol</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">j</span> <span class="o">&amp;</span> <span class="mi">31</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">SS2</span> <span class="o">=</span> <span class="n">SS1</span> <span class="o">^</span> <span class="n">rol</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">FF</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="o">^</span> <span class="n">Bb</span> <span class="o">^</span> <span class="n">C</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="p">((</span><span class="n">A</span> <span class="o">&amp;</span> <span class="n">Bb</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">A</span> <span class="o">&amp;</span> <span class="n">C</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">Bb</span> <span class="o">&amp;</span> <span class="n">C</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">GG</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span> <span class="o">^</span> <span class="n">F</span> <span class="o">^</span> <span class="n">G</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;=</span> <span class="mi">15</span> <span class="k">else</span> <span class="p">((</span><span class="n">E</span> <span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="o">~</span><span class="n">E</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">G</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">            <span class="n">TT1</span> <span class="o">=</span> <span class="p">(</span><span class="n">FF</span> <span class="o">+</span> <span class="n">D</span> <span class="o">+</span> <span class="n">SS2</span> <span class="o">+</span> <span class="n">W1</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">            <span class="n">TT2</span> <span class="o">=</span> <span class="p">(</span><span class="n">GG</span> <span class="o">+</span> <span class="n">H</span> <span class="o">+</span> <span class="n">SS1</span> <span class="o">+</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xFFFFFFFF</span>
</span></span><span class="line"><span class="cl">            <span class="n">D</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">Bb</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">C</span><span class="p">,</span> <span class="n">rol</span><span class="p">(</span><span class="n">Bb</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="n">A</span><span class="p">,</span> <span class="n">TT1</span>
</span></span><span class="line"><span class="cl">            <span class="n">H</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">E</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">rol</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">19</span><span class="p">),</span> <span class="n">E</span><span class="p">,</span> <span class="n">P0</span><span class="p">(</span><span class="n">TT2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">V</span> <span class="o">=</span> <span class="p">[(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">^</span><span class="n">A</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">^</span><span class="n">Bb</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">^</span><span class="n">C</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">^</span><span class="n">D</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">^</span><span class="n">E</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">^</span><span class="n">F</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">^</span><span class="n">G</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">,</span> <span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">^</span><span class="n">H</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0xFFFFFFFF</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">08x</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">V</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_2</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="p">[</span><span class="mi">110</span><span class="p">,</span><span class="mi">89</span><span class="p">,</span><span class="mi">245</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">49</span><span class="p">,</span><span class="mi">72</span><span class="p">,</span><span class="mi">67</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">68</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">165</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">42</span><span class="p">,</span><span class="mi">66</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">22</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">88</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">249</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">94</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span><span class="mi">74</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">87</span><span class="p">,</span><span class="mi">172</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">146</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">43</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">148</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">247</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span><span class="mi">48</span><span class="p">,</span><span class="mi">84</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">59</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span><span class="mi">31</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">81</span><span class="p">,</span><span class="mi">237</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span><span class="mi">186</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">37</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">246</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">56</span><span class="p">,</span><span class="mi">46</span><span class="p">,</span><span class="mi">62</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">86</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">251</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">83</span><span class="p">,</span><span class="mi">97</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">36</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">38</span><span class="p">,</span><span class="mi">57</span><span class="p">,</span><span class="mi">23</span><span class="p">,</span><span class="mi">254</span><span class="p">,</span><span class="mi">63</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">44</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">64</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">132</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">93</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">79</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span><span class="mi">99</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">13</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">183</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">34</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">175</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">147</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">98</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span><span class="mi">117</span><span class="p">,</span><span class="mi">227</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">173</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">69</span><span class="p">,</span><span class="mi">77</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">61</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">41</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span><span class="mi">14</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">82</span><span class="p">,</span><span class="mi">76</span><span class="p">,</span><span class="mi">78</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">167</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">156</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">39</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">16</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">47</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">24</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">73</span><span class="p">,</span><span class="mi">92</span><span class="p">,</span><span class="mi">58</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span><span class="mi">32</span><span class="p">,</span><span class="mi">211</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">96</span><span class="p">,</span><span class="mi">54</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">91</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">232</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span><span class="mi">184</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">33</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span><span class="mi">53</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span><span class="mi">185</span><span class="p">,</span><span class="mi">212</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">K</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&#34;__main__&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">data</span> <span class="o">=</span> <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">rc4_encoded</span> <span class="o">=</span> <span class="n">rc4_2</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;RC4 Encoded bytes:&#34;</span><span class="p">,</span> <span class="n">rc4_encoded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">decoded_data</span> <span class="o">=</span> <span class="n">b64_swap_encode</span><span class="p">(</span><span class="n">rc4_encoded</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Encoded string:&#34;</span><span class="p">,</span> <span class="n">decoded_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">sm3_data</span> <span class="o">=</span> <span class="n">sm3_hex</span><span class="p">(</span><span class="n">decoded_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;SM3 Hash:&#34;</span><span class="p">,</span> <span class="n">sm3_data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;SM3 Decimal values:&#34;</span><span class="p">,</span> <span class="s2">&#34; &#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">sm3_data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">],</span> <span class="mi">16</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sm3_data</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span>
</span></span></code></pre></div><p>这里是UA进行加密</p>
<p><img loading="lazy" src="image-20251113204910673.png" alt="image-20251113204910673"  />
</p>
<p>再刷新一下，发现这个rc4的表是会变的，那就说明这个表的key是每一次不一样的，看一下为什么</p>
<p><img loading="lazy" src="image-20251113215810862.png" alt="image-20251113215810862"  />
</p>
<p>这里应该是索引：[0.00390625, 1, 14]</p>
<p>这个第一个应该是固定的，可以很明显的看出来是1/256 = 0.00390625</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">rc4_2</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bytes</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">    <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">r</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">        <span class="n">a</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">k</span> <span class="o">=</span> <span class="p">(</span><span class="n">k</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="n">k</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">b</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">    <span class="n">table</span> <span class="o">=</span> <span class="n">r</span>
</span></span><span class="line"><span class="cl">    <span class="n">out</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">i</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">j</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span> <span class="o">+</span> <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">K</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">table</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">%</span> <span class="mi">256</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span> <span class="o">^</span> <span class="n">K</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</span></span></code></pre></div><p>这样表就可以生成了</p>
<p><img loading="lazy" src="image-20251113221023510.png" alt="image-20251113221023510"  />
</p>
<p>后面就没可以逆的算法了，都是sm3，请求参数拼接一个dhzx进行两次sm3，再对dhzx单独做两次sm3</p>
<p><img loading="lazy" src="image-20251113210525323.png" alt="image-20251113210525323"  />
</p>
<p><img loading="lazy" src="image-20251113205140533.png" alt="image-20251113205140533"  />
</p>
<p>修改sm3函数</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">enc_sum</span><span class="p">(</span><span class="n">n_str</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">as_hex</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">rotl</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">n</span> <span class="o">&amp;=</span> <span class="mi">31</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span> <span class="o">-</span> <span class="n">n</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">Tj</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mh">0x79cc4519</span>  <span class="c1"># 2043430169</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="mh">0x7a879d8a</span>  <span class="c1"># 2055708042</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;invalid j for Tj&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">FF</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="o">^</span> <span class="n">z</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;invalid j for FF&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">GG</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">^</span> <span class="n">y</span> <span class="o">^</span> <span class="n">z</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">elif</span> <span class="mi">16</span> <span class="o">&lt;=</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">y</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="o">~</span><span class="n">x</span> <span class="o">&amp;</span> <span class="n">z</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">        <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;invalid j for GG&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">class</span> <span class="nc">SM3</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x7380166f</span>  <span class="c1"># 1937774191</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x4914b2b9</span>  <span class="c1"># 1226093241</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x172442d7</span>  <span class="c1"># 388252375</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xda8a0600</span>  <span class="c1"># 3666478592</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xa96f30bc</span>  <span class="c1"># 2842636476</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x163138aa</span>  <span class="c1"># 372324522</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xe38dee4d</span>  <span class="c1"># 3817729613</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0xb0fb0e4e</span>  <span class="c1"># 2969243214</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span> <span class="o">=</span> <span class="nb">bytearray</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">bs</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">,</span> <span class="nb">bytearray</span><span class="p">)):</span>
</span></span><span class="line"><span class="cl">                <span class="n">bs</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">bs</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">bs</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">block</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">[:</span><span class="mi">64</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span><span class="p">(</span><span class="n">block</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">[</span><span class="mi">64</span><span class="p">:]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">_compress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">block</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">block</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">64</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&#34;compress error: not enough data&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">W</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">132</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">                    <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                    <span class="o">|</span> <span class="p">(</span><span class="n">block</span><span class="p">[</span><span class="mi">4</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">                <span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">68</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">tmp</span> <span class="o">=</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">16</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">9</span><span class="p">]</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">3</span><span class="p">],</span> <span class="mi">15</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">tmp</span> <span class="o">=</span> <span class="n">tmp</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">tmp</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">tmp</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">13</span><span class="p">],</span> <span class="mi">7</span><span class="p">)</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">6</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">68</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">W</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^</span> <span class="n">W</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">ss1</span> <span class="o">=</span> <span class="p">(</span><span class="n">rotl</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span> <span class="o">+</span> <span class="n">e</span> <span class="o">+</span> <span class="n">rotl</span><span class="p">(</span><span class="n">Tj</span><span class="p">(</span><span class="n">j</span><span class="p">),</span> <span class="n">j</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">                <span class="n">ss1</span> <span class="o">=</span> <span class="n">rotl</span><span class="p">(</span><span class="n">ss1</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">ss2</span> <span class="o">=</span> <span class="n">ss1</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">tt1</span> <span class="o">=</span> <span class="p">(</span><span class="n">FF</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span> <span class="o">+</span> <span class="n">ss2</span> <span class="o">+</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">68</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">                <span class="n">tt2</span> <span class="o">=</span> <span class="p">(</span><span class="n">GG</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="o">+</span> <span class="n">h</span> <span class="o">+</span> <span class="n">ss1</span> <span class="o">+</span> <span class="n">W</span><span class="p">[</span><span class="n">j</span><span class="p">])</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="n">d</span> <span class="o">=</span> <span class="n">c</span>
</span></span><span class="line"><span class="cl">                <span class="n">c</span> <span class="o">=</span> <span class="n">rotl</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
</span></span><span class="line"><span class="cl">                <span class="n">a</span> <span class="o">=</span> <span class="n">tt1</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">                <span class="n">h</span> <span class="o">=</span> <span class="n">g</span>
</span></span><span class="line"><span class="cl">                <span class="n">g</span> <span class="o">=</span> <span class="n">rotl</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">f</span> <span class="o">=</span> <span class="n">e</span>
</span></span><span class="line"><span class="cl">                <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">tt2</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">tt2</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span> <span class="o">^</span> <span class="n">rotl</span><span class="p">(</span><span class="n">tt2</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">^</span> <span class="n">a</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">^</span> <span class="n">b</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">^</span> <span class="n">c</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="n">d</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">^</span> <span class="n">e</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">^</span> <span class="n">f</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">^</span> <span class="n">g</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">^</span> <span class="n">h</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">8</span>
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mh">0x80</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">while</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">)</span> <span class="o">%</span> <span class="mi">64</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">56</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="n">high</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;&gt;</span> <span class="mi">32</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">            <span class="n">low</span> <span class="o">=</span> <span class="n">t</span> <span class="o">&amp;</span> <span class="mh">0xffffffff</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">high</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">e</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">low</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">8</span> <span class="o">*</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">e</span><span class="p">)))</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">def</span> <span class="nf">sum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">_fill</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">),</span> <span class="mi">64</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="bp">self</span><span class="o">.</span><span class="n">_compress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chunk</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span> <span class="o">+</span> <span class="mi">64</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&#34;hex&#34;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">out</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s2">08x</span><span class="si">}</span><span class="s2">&#34;</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">                <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reg</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span>
</span></span><span class="line"><span class="cl">                        <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">24</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">16</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="p">(</span><span class="n">x</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                        <span class="n">x</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                    <span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="bp">self</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="n">out</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">sm3</span> <span class="o">=</span> <span class="n">SM3</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">as_hex</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">sm3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_str</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&#34;hex&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">sm3</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">n_str</span><span class="p">)</span>
</span></span></code></pre></div><p><img loading="lazy" src="image-20251113222334728.png" alt="image-20251113222334728"  />
</p>
<p>测试解密均可以</p>
<p><img loading="lazy" src="image-20251113222653610.png" alt="image-20251113222653610"  />
</p>
<p>后续再整理，以上是整个过程中自己的所有思路，很乱！仅供参考</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://l0x1c.com/posts/cs106l/">
    <span class="title">« Prev</span>
    <br>
    <span>Stanford CS106L Note (上)</span>
  </a>
  <a class="next" href="https://l0x1c.com/posts/luadec/">
    <span class="title">Next »</span>
    <br>
    <span>unluac xxx_app 分析</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>© <a href="https://github.com/adityatelange/hugo-PaperMod/graphs/contributors">PaperMod Contributors</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
